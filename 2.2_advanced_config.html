
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Advanced Configuration &#8212; IAIFI Summer School Tutorials</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://jduarte.physics.ucsd.edu/iaifi-summer-school/2.2_advanced_config.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compression (Pruning)" href="2.3_compression.html" />
    <link rel="prev" title="Getting Started" href="2.1_getting_started.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">IAIFI Summer School Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    IAIFI Summer School Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Representations, Networks, and Symmetries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1.1_tabular_data_efps.html">
   Tabular Data using Energy Flow Polynomials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1.2_jet_images.html">
   Jet Images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1.3_deep_sets.html">
   Deep Sets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1.4_gnn_in.html">
   Interaction Network GNN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1.5_gnn_lorentz.html">
   Lorentz-Equivariant GNN
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model Compression and Fast Machine Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2.1_getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Advanced Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.3_compression.html">
   Compression (Pruning)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2.4_quantization.html">
   Quantization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/jmduarte/iaifi-summer-school/main?urlpath=tree/book/2.2_advanced_config.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/jmduarte/iaifi-summer-school/blob/main/book/2.2_advanced_config.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/jmduarte/iaifi-summer-school"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/jmduarte/iaifi-summer-school/issues/new?title=Issue%20on%20page%20%2F2.2_advanced_config.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/2.2_advanced_config.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-dataset-and-model-if-you-are-restarting-from-this-point">
   Load the dataset and model (if you are restarting from this point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-a-new-hls4ml-config-model">
   Make a new hls4ml config &amp; model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trace">
   Trace
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inspect">
   Inspect
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compare">
   Compare
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#improving">
     Improving
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Advanced Configuration</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-dataset-and-model-if-you-are-restarting-from-this-point">
   Load the dataset and model (if you are restarting from this point)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-a-new-hls4ml-config-model">
   Make a new hls4ml config &amp; model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trace">
   Trace
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inspect">
   Inspect
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compare">
   Compare
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#improving">
     Improving
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>apt-get  -qq  install  -y  graphviz  <span class="o">&amp;&amp;</span>  pip  install  pydot
<span class="o">!</span>pip  install  -U  matplotlib
<span class="o">!</span>pip  install  git+https://github.com/fastmachinelearning/hls4ml.git@main#egg<span class="o">=</span>hls4ml<span class="o">[</span>profiling<span class="o">]</span>
<span class="o">!</span>pip  install  <span class="nv">qkeras</span><span class="o">==</span><span class="m">0</span>.9.0
<span class="o">!</span>pip install wget
<span class="kn">import</span> <span class="nn">wget</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="c1"># WGET for colab</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;callbacks.py&quot;</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/jmduarte/iaifi-summer-school/main/book/callbacks.py&quot;</span>
    <span class="n">callbacksFile</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;plotting.py&quot;</span><span class="p">):</span>
    <span class="n">urlPlot</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/jmduarte/iaifi-summer-school/main/book/plotting.py&quot;</span>
    <span class="n">plotFile</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">urlPlot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: matplotlib in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (3.5.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pyparsing&gt;=2.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (3.0.9)
Requirement already satisfied: cycler&gt;=0.10 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (4.38.0)
Requirement already satisfied: pillow&gt;=6.2.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (9.3.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (1.4.4)
Requirement already satisfied: numpy&gt;=1.17 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (1.21.6)
Requirement already satisfied: packaging&gt;=20.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (21.3)
Requirement already satisfied: python-dateutil&gt;=2.7 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib) (2.8.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: typing-extensions in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib) (4.4.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: six&gt;=1.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib) (1.16.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting hls4ml[profiling]
  Cloning https://github.com/fastmachinelearning/hls4ml.git (to revision main) to /tmp/pip-install-igchbep4/hls4ml_6614abff0e624d59a32a496de5c55cb6
  Running command git clone --filter=blob:none --quiet https://github.com/fastmachinelearning/hls4ml.git /tmp/pip-install-igchbep4/hls4ml_6614abff0e624d59a32a496de5c55cb6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Resolved https://github.com/fastmachinelearning/hls4ml.git to commit fe9d3e71b03e0422c7643027880310bd2cc02cb1
  Running command git submodule update --init --recursive -q
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Installing build dependencies ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> \
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> /
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> -
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> \
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>?25h  Getting requirements to build wheel ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>?25h  Preparing metadata (pyproject.toml) ... ?25l-
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> \
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> done
?25hRequirement already satisfied: qkeras in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (0.9.0)
Requirement already satisfied: pyyaml in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (6.0)
Requirement already satisfied: onnx&gt;=1.4.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (1.12.0)
Requirement already satisfied: calmjs.parse in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (1.3.0)
Requirement already satisfied: numpy in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (1.21.6)
Requirement already satisfied: tabulate in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (0.9.0)
Requirement already satisfied: pydigitalwavetools==1.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (1.1)
Requirement already satisfied: h5py in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (3.7.0)
Requirement already satisfied: six in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (1.16.0)
Requirement already satisfied: pandas in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (1.3.5)
Requirement already satisfied: seaborn in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (0.12.1)
Requirement already satisfied: matplotlib in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from hls4ml[profiling]) (3.5.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: protobuf&lt;=3.20.1,&gt;=3.12.2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from onnx&gt;=1.4.0-&gt;hls4ml[profiling]) (3.19.6)
Requirement already satisfied: typing-extensions&gt;=3.6.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from onnx&gt;=1.4.0-&gt;hls4ml[profiling]) (4.4.0)
Requirement already satisfied: ply&gt;=3.6 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from calmjs.parse-&gt;hls4ml[profiling]) (3.11)
Requirement already satisfied: setuptools in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from calmjs.parse-&gt;hls4ml[profiling]) (65.5.1)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (3.0.9)
Requirement already satisfied: pillow&gt;=6.2.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (9.3.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (4.38.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (1.4.4)
Requirement already satisfied: cycler&gt;=0.10 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (0.11.0)
Requirement already satisfied: python-dateutil&gt;=2.7 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (2.8.2)
Requirement already satisfied: packaging&gt;=20.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from matplotlib-&gt;hls4ml[profiling]) (21.3)
Requirement already satisfied: pytz&gt;=2017.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pandas-&gt;hls4ml[profiling]) (2022.6)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: keras-tuner&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (1.1.3)
Requirement already satisfied: scipy&gt;=1.4.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (1.7.3)
Requirement already satisfied: tensorflow-model-optimization&gt;=0.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (0.7.3)
Requirement already satisfied: tqdm&gt;=4.48.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (4.64.1)
Requirement already satisfied: scikit-learn&gt;=0.23.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (1.0.2)
Requirement already satisfied: pyparser in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (1.0)
Requirement already satisfied: networkx&gt;=2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras-&gt;hls4ml[profiling]) (2.6.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: kt-legacy in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.0.4)
Requirement already satisfied: tensorboard in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.10.1)
Requirement already satisfied: requests in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.28.1)
Requirement already satisfied: ipython in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (7.34.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: joblib&gt;=0.11 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from scikit-learn&gt;=0.23.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from scikit-learn&gt;=0.23.1-&gt;qkeras-&gt;hls4ml[profiling]) (3.1.0)
Requirement already satisfied: dm-tree~=0.1.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorflow-model-optimization&gt;=0.2.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.1.7)
Requirement already satisfied: parse==1.6.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pyparser-&gt;qkeras-&gt;hls4ml[profiling]) (1.6.5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: jedi&gt;=0.16 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.18.1)
Requirement already satisfied: matplotlib-inline in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.1.6)
Requirement already satisfied: pygments in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.13.0)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (3.0.32)
Requirement already satisfied: pickleshare in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.7.5)
Requirement already satisfied: pexpect&gt;4.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (4.8.0)
Requirement already satisfied: decorator in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (5.1.1)
Requirement already satisfied: backcall in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.2.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: traitlets&gt;=4.2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (5.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2022.9.24)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (3.4)
Requirement already satisfied: charset-normalizer&lt;3,&gt;=2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.1.1)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.26.12)
Requirement already satisfied: grpcio&gt;=1.24.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.50.0)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.14.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: tensorboard-data-server&lt;0.7.0,&gt;=0.6.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.6.1)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.2.2)
Requirement already satisfied: wheel&gt;=0.26 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.38.2)
Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.4.6)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.8.1)
Requirement already satisfied: markdown&gt;=2.6.8 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (3.4.1)
Requirement already satisfied: absl-py&gt;=0.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.3.0)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.2.8)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (4.9)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (5.2.0)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (1.3.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from jedi&gt;=0.16-&gt;ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.8.3)
Requirement already satisfied: importlib-metadata&gt;=4.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from markdown&gt;=2.6.8-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (5.0.0)
Requirement already satisfied: ptyprocess&gt;=0.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pexpect&gt;4.3-&gt;ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.7.0)
Requirement already satisfied: wcwidth in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.2.5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (2.1.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: zipp&gt;=0.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from importlib-metadata&gt;=4.4-&gt;markdown&gt;=2.6.8-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (3.10.0)
Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (0.4.8)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras-&gt;hls4ml[profiling]) (3.2.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: qkeras==0.9.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (0.9.0)
Requirement already satisfied: pyparser in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (1.0)
Requirement already satisfied: scipy&gt;=1.4.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (1.7.3)
Requirement already satisfied: tensorflow-model-optimization&gt;=0.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (0.7.3)
Requirement already satisfied: tqdm&gt;=4.48.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (4.64.1)
Requirement already satisfied: scikit-learn&gt;=0.23.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (1.0.2)
Requirement already satisfied: setuptools&gt;=41.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (65.5.1)
Requirement already satisfied: networkx&gt;=2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (2.6.3)
Requirement already satisfied: numpy&gt;=1.16.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (1.21.6)
Requirement already satisfied: keras-tuner&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from qkeras==0.9.0) (1.1.3)
Requirement already satisfied: requests in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.28.1)
Requirement already satisfied: ipython in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (7.34.0)
Requirement already satisfied: packaging in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (21.3)
Requirement already satisfied: kt-legacy in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (1.0.4)
Requirement already satisfied: tensorboard in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.10.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: joblib&gt;=0.11 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from scikit-learn&gt;=0.23.1-&gt;qkeras==0.9.0) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from scikit-learn&gt;=0.23.1-&gt;qkeras==0.9.0) (3.1.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: dm-tree~=0.1.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorflow-model-optimization&gt;=0.2.1-&gt;qkeras==0.9.0) (0.1.7)
Requirement already satisfied: six~=1.10 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorflow-model-optimization&gt;=0.2.1-&gt;qkeras==0.9.0) (1.16.0)
Requirement already satisfied: parse==1.6.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pyparser-&gt;qkeras==0.9.0) (1.6.5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: jedi&gt;=0.16 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.18.1)
Requirement already satisfied: pickleshare in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.7.5)
Requirement already satisfied: pexpect&gt;4.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (4.8.0)
Requirement already satisfied: traitlets&gt;=4.2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (5.5.0)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.0.32)
Requirement already satisfied: pygments in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.13.0)
Requirement already satisfied: matplotlib-inline in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.1.6)
Requirement already satisfied: backcall in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.2.0)
Requirement already satisfied: decorator in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (5.1.1)
Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from packaging-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.0.9)
Requirement already satisfied: charset-normalizer&lt;3,&gt;=2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.1.1)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2022.9.24)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.4)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (1.26.12)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: google-auth-oauthlib&lt;0.5,&gt;=0.4.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.4.6)
Requirement already satisfied: tensorboard-plugin-wit&gt;=1.6.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (1.8.1)
Requirement already satisfied: protobuf&lt;3.20,&gt;=3.9.2 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.19.6)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.14.1)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.2.2)
Requirement already satisfied: wheel&gt;=0.26 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.38.2)
Requirement already satisfied: markdown&gt;=2.6.8 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.4.1)
Requirement already satisfied: absl-py&gt;=0.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (1.3.0)
Requirement already satisfied: grpcio&gt;=1.24.3 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (1.50.0)
Requirement already satisfied: tensorboard-data-server&lt;0.7.0,&gt;=0.6.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.6.1)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.2.8)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (5.2.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (1.3.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from jedi&gt;=0.16-&gt;ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.8.3)
Requirement already satisfied: importlib-metadata&gt;=4.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from markdown&gt;=2.6.8-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (5.0.0)
Requirement already satisfied: ptyprocess&gt;=0.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pexpect&gt;4.3-&gt;ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.7.0)
Requirement already satisfied: wcwidth in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;ipython-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.2.5)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: MarkupSafe&gt;=2.1.1 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from werkzeug&gt;=1.0.1-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (2.1.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: typing-extensions&gt;=3.6.4 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from importlib-metadata&gt;=4.4-&gt;markdown&gt;=2.6.8-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (4.4.0)
Requirement already satisfied: zipp&gt;=0.5 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from importlib-metadata&gt;=4.4-&gt;markdown&gt;=2.6.8-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.10.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pyasn1&lt;0.5.0,&gt;=0.4.6 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (0.4.8)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;0.5,&gt;=0.4.1-&gt;tensorboard-&gt;keras-tuner&gt;=1.0.1-&gt;qkeras==0.9.0) (3.2.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: wget in /opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages (3.2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FOR COLAB ONLY</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;./iaifi-summer-school&quot;</span><span class="p">):</span>
    <span class="o">!</span>git clone https://github.com/jmduarte/iaifi-summer-school.git
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning into &#39;iaifi-summer-school&#39;...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remote: Enumerating objects: 1755, done.
remote: Counting objects:   0% (1/418)
remote: Counting objects:   1% (5/418)
remote: Counting objects:   2% (9/418)
remote: Counting objects:   3% (13/418)
remote: Counting objects:   4% (17/418)
remote: Counting objects:   5% (21/418)
remote: Counting objects:   6% (26/418)
remote: Counting objects:   7% (30/418)
remote: Counting objects:   8% (34/418)
remote: Counting objects:   9% (38/418)
remote: Counting objects:  10% (42/418)
remote: Counting objects:  11% (46/418)
remote: Counting objects:  12% (51/418)
remote: Counting objects:  13% (55/418)
remote: Counting objects:  14% (59/418)
remote: Counting objects:  15% (63/418)
remote: Counting objects:  16% (67/418)
remote: Counting objects:  17% (72/418)
remote: Counting objects:  18% (76/418)
remote: Counting objects:  19% (80/418)
remote: Counting objects:  20% (84/418)
remote: Counting objects:  21% (88/418)
remote: Counting objects:  22% (92/418)
remote: Counting objects:  23% (97/418)
remote: Counting objects:  24% (101/418)
remote: Counting objects:  25% (105/418)
remote: Counting objects:  26% (109/418)
remote: Counting objects:  27% (113/418)
remote: Counting objects:  28% (118/418)
remote: Counting objects:  29% (122/418)
remote: Counting objects:  30% (126/418)
remote: Counting objects:  31% (130/418)
remote: Counting objects:  32% (134/418)
remote: Counting objects:  33% (138/418)
remote: Counting objects:  34% (143/418)
remote: Counting objects:  35% (147/418)
remote: Counting objects:  36% (151/418)
remote: Counting objects:  37% (155/418)
remote: Counting objects:  38% (159/418)
remote: Counting objects:  39% (164/418)
remote: Counting objects:  40% (168/418)
remote: Counting objects:  41% (172/418)
remote: Counting objects:  42% (176/418)
remote: Counting objects:  43% (180/418)
remote: Counting objects:  44% (184/418)
remote: Counting objects:  45% (189/418)
remote: Counting objects:  46% (193/418)
remote: Counting objects:  47% (197/418)
remote: Counting objects:  48% (201/418)
remote: Counting objects:  49% (205/418)
remote: Counting objects:  50% (209/418)
remote: Counting objects:  51% (214/418)
remote: Counting objects:  52% (218/418)
remote: Counting objects:  53% (222/418)
remote: Counting objects:  54% (226/418)
remote: Counting objects:  55% (230/418)
remote: Counting objects:  56% (235/418)
remote: Counting objects:  57% (239/418)
remote: Counting objects:  58% (243/418)
remote: Counting objects:  59% (247/418)
remote: Counting objects:  60% (251/418)
remote: Counting objects:  61% (255/418)
remote: Counting objects:  62% (260/418)
remote: Counting objects:  63% (264/418)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remote: Counting objects:  64% (268/418)
remote: Counting objects:  65% (272/418)
remote: Counting objects:  66% (276/418)
remote: Counting objects:  67% (281/418)
remote: Counting objects:  68% (285/418)
remote: Counting objects:  69% (289/418)
remote: Counting objects:  70% (293/418)
remote: Counting objects:  71% (297/418)
remote: Counting objects:  72% (301/418)
remote: Counting objects:  73% (306/418)
remote: Counting objects:  74% (310/418)
remote: Counting objects:  75% (314/418)
remote: Counting objects:  76% (318/418)
remote: Counting objects:  77% (322/418)
remote: Counting objects:  78% (327/418)
remote: Counting objects:  79% (331/418)
remote: Counting objects:  80% (335/418)
remote: Counting objects:  81% (339/418)
remote: Counting objects:  82% (343/418)
remote: Counting objects:  83% (347/418)
remote: Counting objects:  84% (352/418)
remote: Counting objects:  85% (356/418)
remote: Counting objects:  86% (360/418)
remote: Counting objects:  87% (364/418)
remote: Counting objects:  88% (368/418)
remote: Counting objects:  89% (373/418)
remote: Counting objects:  90% (377/418)
remote: Counting objects:  91% (381/418)
remote: Counting objects:  92% (385/418)
remote: Counting objects:  93% (389/418)
remote: Counting objects:  94% (393/418)
remote: Counting objects:  95% (398/418)
remote: Counting objects:  96% (402/418)
remote: Counting objects:  97% (406/418)
remote: Counting objects:  98% (410/418)
remote: Counting objects:  99% (414/418)
remote: Counting objects: 100% (418/418)
remote: Counting objects: 100% (418/418), done.
remote: Compressing objects:   0% (1/308)
remote: Compressing objects:   1% (4/308)
remote: Compressing objects:   2% (7/308)
remote: Compressing objects:   3% (10/308)
remote: Compressing objects:   4% (13/308)
remote: Compressing objects:   5% (16/308)
remote: Compressing objects:   6% (19/308)
remote: Compressing objects:   7% (22/308)
remote: Compressing objects:   8% (25/308)
remote: Compressing objects:   9% (28/308)
remote: Compressing objects:  10% (31/308)
remote: Compressing objects:  11% (34/308)
remote: Compressing objects:  12% (37/308)
remote: Compressing objects:  13% (41/308)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remote: Compressing objects:  14% (44/308)
remote: Compressing objects:  15% (47/308)
remote: Compressing objects:  16% (50/308)
remote: Compressing objects:  17% (53/308)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remote: Compressing objects:  18% (56/308)
remote: Compressing objects:  19% (59/308)
remote: Compressing objects:  20% (62/308)
remote: Compressing objects:  21% (65/308)
remote: Compressing objects:  22% (68/308)
remote: Compressing objects:  23% (71/308)
remote: Compressing objects:  24% (74/308)
remote: Compressing objects:  25% (77/308)
remote: Compressing objects:  26% (81/308)
remote: Compressing objects:  27% (84/308)
remote: Compressing objects:  28% (87/308)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remote: Compressing objects:  29% (90/308)
remote: Compressing objects:  30% (93/308)
remote: Compressing objects:  31% (96/308)
remote: Compressing objects:  32% (99/308)
remote: Compressing objects:  33% (102/308)
remote: Compressing objects:  34% (105/308)
remote: Compressing objects:  35% (108/308)
remote: Compressing objects:  36% (111/308)
remote: Compressing objects:  37% (114/308)
remote: Compressing objects:  38% (118/308)
remote: Compressing objects:  39% (121/308)
remote: Compressing objects:  40% (124/308)
remote: Compressing objects:  41% (127/308)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>remote: Compressing objects:  42% (130/308)
remote: Compressing objects:  43% (133/308)
remote: Compressing objects:  44% (136/308)
remote: Compressing objects:  45% (139/308)
remote: Compressing objects:  46% (142/308)
remote: Compressing objects:  47% (145/308)
remote: Compressing objects:  48% (148/308)
remote: Compressing objects:  49% (151/308)
remote: Compressing objects:  50% (154/308)
remote: Compressing objects:  51% (158/308)
remote: Compressing objects:  52% (161/308)
remote: Compressing objects:  53% (164/308)
remote: Compressing objects:  54% (167/308)
remote: Compressing objects:  55% (170/308)
remote: Compressing objects:  56% (173/308)
remote: Compressing objects:  57% (176/308)
remote: Compressing objects:  58% (179/308)
remote: Compressing objects:  59% (182/308)
remote: Compressing objects:  60% (185/308)
remote: Compressing objects:  61% (188/308)
remote: Compressing objects:  62% (191/308)
remote: Compressing objects:  63% (195/308)
remote: Compressing objects:  64% (198/308)
remote: Compressing objects:  65% (201/308)
remote: Compressing objects:  66% (204/308)
remote: Compressing objects:  67% (207/308)
remote: Compressing objects:  68% (210/308)
remote: Compressing objects:  69% (213/308)
remote: Compressing objects:  70% (216/308)
remote: Compressing objects:  71% (219/308)
remote: Compressing objects:  72% (222/308)
remote: Compressing objects:  73% (225/308)
remote: Compressing objects:  74% (228/308)
remote: Compressing objects:  75% (231/308)
remote: Compressing objects:  76% (235/308)
remote: Compressing objects:  77% (238/308)
remote: Compressing objects:  78% (241/308)
remote: Compressing objects:  79% (244/308)
remote: Compressing objects:  80% (247/308)
remote: Compressing objects:  81% (250/308)
remote: Compressing objects:  82% (253/308)
remote: Compressing objects:  83% (256/308)
remote: Compressing objects:  84% (259/308)
remote: Compressing objects:  85% (262/308)
remote: Compressing objects:  86% (265/308)
remote: Compressing objects:  87% (268/308)
remote: Compressing objects:  88% (272/308)
remote: Compressing objects:  89% (275/308)
remote: Compressing objects:  90% (278/308)
remote: Compressing objects:  91% (281/308)
remote: Compressing objects:  92% (284/308)
remote: Compressing objects:  93% (287/308)
remote: Compressing objects:  94% (290/308)
remote: Compressing objects:  95% (293/308)
remote: Compressing objects:  96% (296/308)
remote: Compressing objects:  97% (299/308)
remote: Compressing objects:  98% (302/308)
remote: Compressing objects:  99% (305/308)
remote: Compressing objects: 100% (308/308)
remote: Compressing objects: 100% (308/308), done.
Receiving objects:   0% (1/1755)
Receiving objects:   1% (18/1755)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:   2% (36/1755)
Receiving objects:   3% (53/1755)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:   4% (71/1755)
Receiving objects:   5% (88/1755)
Receiving objects:   6% (106/1755)
Receiving objects:   7% (123/1755)
Receiving objects:   8% (141/1755)
Receiving objects:   9% (158/1755)
Receiving objects:  10% (176/1755)
Receiving objects:  11% (194/1755)
Receiving objects:  12% (211/1755)
Receiving objects:  13% (229/1755)
Receiving objects:  14% (246/1755)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  15% (264/1755)
Receiving objects:  16% (281/1755)
Receiving objects:  17% (299/1755)
Receiving objects:  18% (316/1755)
Receiving objects:  19% (334/1755)
Receiving objects:  20% (351/1755)
Receiving objects:  21% (369/1755)
Receiving objects:  22% (387/1755)
Receiving objects:  23% (404/1755)
Receiving objects:  24% (422/1755)
Receiving objects:  25% (439/1755)
Receiving objects:  26% (457/1755)
Receiving objects:  27% (474/1755)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  28% (492/1755)
Receiving objects:  29% (509/1755)
Receiving objects:  30% (527/1755)
Receiving objects:  31% (545/1755)
Receiving objects:  32% (562/1755)
Receiving objects:  33% (580/1755)
Receiving objects:  34% (597/1755)
Receiving objects:  35% (615/1755)
Receiving objects:  36% (632/1755)
Receiving objects:  37% (650/1755)
Receiving objects:  38% (667/1755)
Receiving objects:  39% (685/1755)
Receiving objects:  40% (702/1755)
Receiving objects:  41% (720/1755)
Receiving objects:  42% (738/1755)
Receiving objects:  43% (755/1755)
Receiving objects:  44% (773/1755)
Receiving objects:  45% (790/1755)
Receiving objects:  46% (808/1755)
Receiving objects:  47% (825/1755)
Receiving objects:  48% (843/1755)
Receiving objects:  49% (860/1755)
Receiving objects:  50% (878/1755)
Receiving objects:  51% (896/1755)
Receiving objects:  52% (913/1755)
Receiving objects:  53% (931/1755)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  54% (948/1755)
Receiving objects:  55% (966/1755)
Receiving objects:  56% (983/1755)
Receiving objects:  57% (1001/1755)
Receiving objects:  58% (1018/1755)
Receiving objects:  59% (1036/1755)
Receiving objects:  60% (1053/1755)
Receiving objects:  61% (1071/1755)
Receiving objects:  62% (1089/1755)
Receiving objects:  63% (1106/1755)
Receiving objects:  64% (1124/1755)
Receiving objects:  65% (1141/1755)
Receiving objects:  66% (1159/1755)
Receiving objects:  67% (1176/1755)
Receiving objects:  68% (1194/1755)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  69% (1211/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  70% (1229/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  71% (1247/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  72% (1264/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  73% (1282/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  74% (1299/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  75% (1317/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  76% (1334/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  77% (1352/1755), 16.12 MiB | 32.22 MiB/s
Receiving objects:  78% (1369/1755), 16.12 MiB | 32.22 MiB/s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  78% (1386/1755), 43.29 MiB | 43.28 MiB/s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  78% (1386/1755), 102.21 MiB | 51.10 MiB/s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  79% (1387/1755), 102.21 MiB | 51.10 MiB/s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  80% (1404/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  81% (1422/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  82% (1440/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  83% (1457/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  84% (1475/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  85% (1492/1755), 102.21 MiB | 51.10 MiB/s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  86% (1510/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  87% (1527/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  88% (1545/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  89% (1562/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  90% (1580/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  91% (1598/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  92% (1615/1755), 102.21 MiB | 51.10 MiB/s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Receiving objects:  93% (1633/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  94% (1650/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  95% (1668/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  96% (1685/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  97% (1703/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  98% (1720/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects:  99% (1738/1755), 102.21 MiB | 51.10 MiB/s
remote: Total 1755 (delta 153), reused 354 (delta 108), pack-reused 1337
Receiving objects: 100% (1755/1755), 102.21 MiB | 51.10 MiB/s
Receiving objects: 100% (1755/1755), 114.49 MiB | 49.05 MiB/s, done.
Resolving deltas:   0% (0/912)
Resolving deltas:   1% (10/912)
Resolving deltas:   2% (19/912)
Resolving deltas:   3% (28/912)
Resolving deltas:   4% (37/912)
Resolving deltas:   5% (46/912)
Resolving deltas:   6% (55/912)
Resolving deltas:   7% (64/912)
Resolving deltas:   8% (73/912)
Resolving deltas:   9% (83/912)
Resolving deltas:  10% (92/912)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving deltas:  11% (101/912)
Resolving deltas:  12% (110/912)
Resolving deltas:  13% (119/912)
Resolving deltas:  14% (128/912)
Resolving deltas:  15% (137/912)
Resolving deltas:  16% (146/912)
Resolving deltas:  17% (156/912)
Resolving deltas:  18% (165/912)
Resolving deltas:  19% (174/912)
Resolving deltas:  20% (183/912)
Resolving deltas:  21% (192/912)
Resolving deltas:  22% (201/912)
Resolving deltas:  23% (210/912)
Resolving deltas:  24% (219/912)
Resolving deltas:  25% (228/912)
Resolving deltas:  26% (238/912)
Resolving deltas:  27% (247/912)
Resolving deltas:  28% (256/912)
Resolving deltas:  29% (265/912)
Resolving deltas:  30% (274/912)
Resolving deltas:  31% (283/912)
Resolving deltas:  32% (292/912)
Resolving deltas:  33% (301/912)
Resolving deltas:  34% (311/912)
Resolving deltas:  35% (320/912)
Resolving deltas:  36% (329/912)
Resolving deltas:  37% (338/912)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving deltas:  38% (347/912)
Resolving deltas:  39% (356/912)
Resolving deltas:  40% (365/912)
Resolving deltas:  41% (374/912)
Resolving deltas:  42% (384/912)
Resolving deltas:  43% (393/912)
Resolving deltas:  44% (402/912)
Resolving deltas:  45% (411/912)
Resolving deltas:  46% (420/912)
Resolving deltas:  47% (429/912)
Resolving deltas:  48% (438/912)
Resolving deltas:  49% (447/912)
Resolving deltas:  50% (456/912)
Resolving deltas:  51% (466/912)
Resolving deltas:  52% (475/912)
Resolving deltas:  53% (484/912)
Resolving deltas:  54% (493/912)
Resolving deltas:  55% (502/912)
Resolving deltas:  56% (511/912)
Resolving deltas:  57% (520/912)
Resolving deltas:  58% (529/912)
Resolving deltas:  59% (539/912)
Resolving deltas:  60% (548/912)
Resolving deltas:  61% (557/912)
Resolving deltas:  62% (566/912)
Resolving deltas:  63% (575/912)
Resolving deltas:  64% (584/912)
Resolving deltas:  65% (593/912)
Resolving deltas:  66% (602/912)
Resolving deltas:  67% (612/912)
Resolving deltas:  68% (621/912)
Resolving deltas:  69% (630/912)
Resolving deltas:  70% (639/912)
Resolving deltas:  71% (648/912)
Resolving deltas:  72% (657/912)
Resolving deltas:  73% (666/912)
Resolving deltas:  74% (675/912)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resolving deltas:  75% (684/912)
Resolving deltas:  76% (694/912)
Resolving deltas:  77% (703/912)
Resolving deltas:  78% (712/912)
Resolving deltas:  79% (721/912)
Resolving deltas:  80% (730/912)
Resolving deltas:  81% (739/912)
Resolving deltas:  82% (748/912)
Resolving deltas:  83% (757/912)
Resolving deltas:  84% (767/912)
Resolving deltas:  85% (776/912)
Resolving deltas:  86% (785/912)
Resolving deltas:  87% (794/912)
Resolving deltas:  88% (803/912)
Resolving deltas:  89% (812/912)
Resolving deltas:  90% (821/912)
Resolving deltas:  91% (830/912)
Resolving deltas:  92% (840/912)
Resolving deltas:  93% (849/912)
Resolving deltas:  94% (858/912)
Resolving deltas:  95% (867/912)
Resolving deltas:  96% (876/912)
Resolving deltas:  97% (885/912)
Resolving deltas:  98% (894/912)
Resolving deltas:  99% (903/912)
Resolving deltas: 100% (912/912)
Resolving deltas: 100% (912/912), done.
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="advanced-configuration">
<h1>Advanced Configuration<a class="headerlink" href="#advanced-configuration" title="Permalink to this headline">#</a></h1>
<section id="load-the-dataset-and-model-if-you-are-restarting-from-this-point">
<h2>Load the dataset and model (if you are restarting from this point)<a class="headerlink" href="#load-the-dataset-and-model-if-you-are-restarting-from-this-point" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">plotting</span>

<span class="c1"># import os</span>
<span class="c1"># os.environ[&#39;PATH&#39;] = &#39;/opt/Xilinx/Vivado/2019.2/bin:&#39; + os.environ[&#39;PATH&#39;]</span>
<span class="c1"># for this tutorial we wont be actually running Vivado, so I have commented these lines out</span>
<span class="c1">#     but if you want to look into actually running on an FPGA then simply uncomment these lines</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">#UNCOMMENT THIS IF LOCAL</span>
<span class="sd">X_train_val = np.load(&quot;X_train_val.npy&quot;)</span>
<span class="sd">X_test = np.ascontiguousarray(np.load(&quot;X_test.npy&quot;))</span>
<span class="sd">y_train_val = np.load(&quot;y_train_val.npy&quot;)</span>
<span class="sd">y_test = np.load(&quot;y_test.npy&quot;, allow_pickle=True)</span>
<span class="sd">classes = np.load(&quot;classes.npy&quot;, allow_pickle=True)</span>

<span class="sd">from tensorflow.keras.models import load_model</span>

<span class="sd">model = load_model(&quot;model_1/KERAS_check_best_model.h5&quot;)</span>
<span class="sd">y_keras = model.predict(X_test)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#IF YOU&#39;RE ON COLAB</span>
<span class="n">X_train_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;iaifi-summer-school/book/X_train_val.npy&quot;</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;iaifi-summer-school/book/X_test.npy&quot;</span><span class="p">))</span>
<span class="n">y_train_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;iaifi-summer-school/book/y_train_val.npy&quot;</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;iaifi-summer-school/book/y_test.npy&quot;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;iaifi-summer-school/book/classes.npy&quot;</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;iaifi-summer-school/book/model_1/KERAS_check_best_model.h5&quot;</span><span class="p">)</span>
<span class="n">y_keras</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-11-08 17:46:25.234681: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-11-08 17:46:25.387991: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcudart.so.11.0&#39;; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.7.15/x64/lib
2022-11-08 17:46:25.388014: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2022-11-08 17:46:25.420384: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-11-08 17:46:26.252418: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libnvinfer.so.7&#39;; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.7.15/x64/lib
2022-11-08 17:46:26.252505: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libnvinfer_plugin.so.7&#39;; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.7.15/x64/lib
2022-11-08 17:46:26.252515: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-11-08 17:46:28.409106: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library &#39;libcuda.so.1&#39;; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.7.15/x64/lib
2022-11-08 17:46:28.409140: W tensorflow/stream_executor/cuda/cuda_driver.cc:263] failed call to cuInit: UNKNOWN ERROR (303)
2022-11-08 17:46:28.409165: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (fv-az196-389): /proc/driver/nvidia/version does not exist
2022-11-08 17:46:28.409470: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   1/5188 [..............................] - ETA: 11:38
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  52/5188 [..............................] - ETA: 5s   
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 107/5188 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 162/5188 [..............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 217/5188 [&gt;.............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 273/5188 [&gt;.............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 329/5188 [&gt;.............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 383/5188 [=&gt;............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 438/5188 [=&gt;............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 494/5188 [=&gt;............................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 549/5188 [==&gt;...........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 605/5188 [==&gt;...........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 661/5188 [==&gt;...........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 716/5188 [===&gt;..........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 771/5188 [===&gt;..........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 826/5188 [===&gt;..........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 881/5188 [====&gt;.........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 936/5188 [====&gt;.........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 992/5188 [====&gt;.........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1042/5188 [=====&gt;........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1097/5188 [=====&gt;........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1152/5188 [=====&gt;........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1207/5188 [=====&gt;........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1258/5188 [======&gt;.......................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1313/5188 [======&gt;.......................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1368/5188 [======&gt;.......................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1423/5188 [=======&gt;......................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1477/5188 [=======&gt;......................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1531/5188 [=======&gt;......................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1586/5188 [========&gt;.....................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1641/5188 [========&gt;.....................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1696/5188 [========&gt;.....................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1751/5188 [=========&gt;....................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1806/5188 [=========&gt;....................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1861/5188 [=========&gt;....................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1911/5188 [==========&gt;...................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
1966/5188 [==========&gt;...................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2022/5188 [==========&gt;...................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2078/5188 [===========&gt;..................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2134/5188 [===========&gt;..................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2189/5188 [===========&gt;..................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2244/5188 [===========&gt;..................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2299/5188 [============&gt;.................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2354/5188 [============&gt;.................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2408/5188 [============&gt;.................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2462/5188 [=============&gt;................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2516/5188 [=============&gt;................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2570/5188 [=============&gt;................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2624/5188 [==============&gt;...............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2679/5188 [==============&gt;...............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2734/5188 [==============&gt;...............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2789/5188 [===============&gt;..............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2843/5188 [===============&gt;..............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2897/5188 [===============&gt;..............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
2952/5188 [================&gt;.............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3006/5188 [================&gt;.............] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3061/5188 [================&gt;.............] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3113/5188 [=================&gt;............] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3167/5188 [=================&gt;............] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3220/5188 [=================&gt;............] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3275/5188 [=================&gt;............] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3330/5188 [==================&gt;...........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3384/5188 [==================&gt;...........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3439/5188 [==================&gt;...........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3494/5188 [===================&gt;..........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3549/5188 [===================&gt;..........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3604/5188 [===================&gt;..........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3660/5188 [====================&gt;.........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3715/5188 [====================&gt;.........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3770/5188 [====================&gt;.........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3825/5188 [=====================&gt;........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3880/5188 [=====================&gt;........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3935/5188 [=====================&gt;........] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
3991/5188 [======================&gt;.......] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4046/5188 [======================&gt;.......] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4101/5188 [======================&gt;.......] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4156/5188 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4211/5188 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4266/5188 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4320/5188 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4371/5188 [========================&gt;.....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4426/5188 [========================&gt;.....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4480/5188 [========================&gt;.....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4534/5188 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4588/5188 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4643/5188 [=========================&gt;....] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4698/5188 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4752/5188 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4807/5188 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4862/5188 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4917/5188 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
4972/5188 [===========================&gt;..] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
5027/5188 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
5082/5188 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
5137/5188 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
5188/5188 [==============================] - 5s 923us/step
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-a-new-hls4ml-config-model">
<h2>Make a new hls4ml config &amp; model<a class="headerlink" href="#make-a-new-hls4ml-config-model" title="Permalink to this headline">#</a></h2>
<p>This time, well create a config with finer granularity. When we print the config dictionary, youll notice that an entry is created for each named Layer of the model. See for the first layer, for example:</p>
<div class="highlight-LayerName: notranslate"><div class="highlight"><pre><span></span>    fc1:
        Precision:
            weight: ap_fixed&lt;10,4&gt;
            bias:   ap_fixed&lt;10,4&gt;
            result: ap_fixed&lt;10,4&gt;
        ReuseFactor: 1
</pre></div>
</div>
<p>We will also modify the default_precision to be smaller than we know is good just to demonstrate the effect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hls4ml</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">hls4ml</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">config_from_keras_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">granularity</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">default_precision</span><span class="o">=</span><span class="s2">&quot;ap_fixed&lt;10,4&gt;&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------&quot;</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">print_dict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpreting Sequential
Topology:
Layer name: fc1_input, layer type: Input
Layer name: fc1, layer type: Dense
  -&gt; Activation (linear), layer name: fc1
Layer name: relu1, layer type: Activation
Layer name: fc2, layer type: Dense
  -&gt; Activation (linear), layer name: fc2
Layer name: relu2, layer type: Activation
Layer name: fc3, layer type: Dense
  -&gt; Activation (linear), layer name: fc3
Layer name: relu3, layer type: Activation
Layer name: output, layer type: Dense
  -&gt; Activation (linear), layer name: output
Layer name: softmax, layer type: Activation
-----------------------------------
Model
  Precision:         ap_fixed&lt;10,4&gt;
  ReuseFactor:       1
  Strategy:          Latency
LayerName
  fc1_input
    Precision
      result:        ap_fixed&lt;10,4&gt;
  fc1
    Precision
      weight:        ap_fixed&lt;10,4&gt;
      bias:          ap_fixed&lt;10,4&gt;
      result:        ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
  fc1_linear
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  relu1
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  fc2
    Precision
      weight:        ap_fixed&lt;10,4&gt;
      bias:          ap_fixed&lt;10,4&gt;
      result:        ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
  fc2_linear
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  relu2
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  fc3
    Precision
      weight:        ap_fixed&lt;10,4&gt;
      bias:          ap_fixed&lt;10,4&gt;
      result:        ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
  fc3_linear
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  relu3
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  output
    Precision
      weight:        ap_fixed&lt;10,4&gt;
      bias:          ap_fixed&lt;10,4&gt;
      result:        ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
  output_linear
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    table_t:         ap_fixed&lt;18,8&gt;
  softmax
    Precision:       ap_fixed&lt;10,4&gt;
    ReuseFactor:     1
    table_size:      1024
    exp_table_t:     ap_fixed&lt;18,8,AP_RND,AP_SAT&gt;
    inv_table_t:     ap_fixed&lt;18,8,AP_RND,AP_SAT&gt;
-----------------------------------
</pre></div>
</div>
</div>
</div>
</section>
<section id="profiling">
<h2>Profiling<a class="headerlink" href="#profiling" title="Permalink to this headline">#</a></h2>
<p>As you can see, hls4ml will allow is to choose the precision of <em>everything</em> in our Neural Network. This is a powerful way to tune the performance, but its also complicated. Luckily there are tools in <code class="docutils literal notranslate"><span class="pre">hls4ml.model.profiling</span></code> that will help choose the right precision for a given model.</p>
<p>The first thing we will do is to numerically profile the model. This method plots the distribution of the weights (and biases) as a box and whisker plot. The grey boxes show the values which can be represented with the data types used in the <code class="docutils literal notranslate"><span class="pre">hls_model</span></code>. Generally, you need the box to overlap completely with the whisker to the right (large values) otherwise youll get saturation &amp; wrap-around issues from exceeding the top of the fixed-point range. It can be okay for the box not to overlap completely to the left (small values), but finding how small you can go is a matter of trial-and-error.</p>
<p>Providing data, in this case just using the first 1000 examples for speed, will show the same distributions captured at the output of each layer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;LayerName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">config</span><span class="p">[</span><span class="s2">&quot;LayerName&quot;</span><span class="p">][</span><span class="n">layer</span><span class="p">][</span><span class="s2">&quot;Trace&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">hls_model</span> <span class="o">=</span> <span class="n">hls4ml</span><span class="o">.</span><span class="n">converters</span><span class="o">.</span><span class="n">convert_from_keras_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">hls_config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;model_1/hls4ml_prj_2&quot;</span><span class="p">,</span>
    <span class="n">part</span><span class="o">=</span><span class="s2">&quot;xcu250-figd2104-2L-e&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">hls4ml</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">profiling</span><span class="o">.</span><span class="n">numerical</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">hls_model</span><span class="o">=</span><span class="n">hls_model</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpreting Sequential
Topology:
Layer name: fc1_input, layer type: InputLayer, input shapes: [[None, 16]], output shape: [None, 16]
Layer name: fc1, layer type: Dense, input shapes: [[None, 16]], output shape: [None, 64]
Layer name: relu1, layer type: Activation, input shapes: [[None, 64]], output shape: [None, 64]
Layer name: fc2, layer type: Dense, input shapes: [[None, 64]], output shape: [None, 32]
Layer name: relu2, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: fc3, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: relu3, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: output, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 5]
Layer name: softmax, layer type: Softmax, input shapes: [[None, 5]], output shape: [None, 5]
Creating HLS model
Interpreting Sequential
Topology:
Layer name: fc1_input, layer type: InputLayer, input shapes: [[None, 16]], output shape: [None, 16]
Layer name: fc1, layer type: Dense, input shapes: [[None, 16]], output shape: [None, 64]
Layer name: relu1, layer type: Activation, input shapes: [[None, 64]], output shape: [None, 64]
Layer name: fc2, layer type: Dense, input shapes: [[None, 64]], output shape: [None, 32]
Layer name: relu2, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: fc3, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: relu3, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: output, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 5]
Layer name: softmax, layer type: Softmax, input shapes: [[None, 5]], output shape: [None, 5]
Creating HLS model
Profiling weights (before optimization)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Profiling weights (final / after optimization)
Profiling activations (before optimization)
   fc1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 903us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   relu1

 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 934us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   fc2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 942us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   relu2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 941us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   fc3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 953us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   relu3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 931us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   output
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 978us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   softmax
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1/32 [..............................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
32/32 [==============================] - 0s 1ms/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Profiling activations (final / after optimization)
Recompiling myproject with tracing
Writing HLS project
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   fc1
   relu1
   fc2
   relu2
   fc3
   relu3
   output
   softmax
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 640x480 with 1 Axes&gt;,
 &lt;Figure size 640x480 with 1 Axes&gt;,
 &lt;Figure size 640x480 with 1 Axes&gt;,
 &lt;Figure size 640x480 with 1 Axes&gt;)
</pre></div>
</div>
<img alt="_images/2.2_advanced_config_8_28.png" src="_images/2.2_advanced_config_8_28.png" />
<img alt="_images/2.2_advanced_config_8_29.png" src="_images/2.2_advanced_config_8_29.png" />
<img alt="_images/2.2_advanced_config_8_30.png" src="_images/2.2_advanced_config_8_30.png" />
<img alt="_images/2.2_advanced_config_8_31.png" src="_images/2.2_advanced_config_8_31.png" />
</div>
</div>
<p>We can see that in this case the default precision of <code class="docutils literal notranslate"><span class="pre">ap_fixed&lt;16,6&gt;</span></code> will fully cover the upper range of the outputs from each layer. This is fully consistent with what we saw earlier from the ROC curve where the fixed-point model was capable of reproducing the floating point result. However, we know that reducing the integer or fractional precision slightly will begin to result in degraded performance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hls_model</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="n">y_hls</span> <span class="o">=</span> <span class="n">hls_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Keras  Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">accuracy_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_keras</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;hls4ml Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">accuracy_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_hls</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">makeRoc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_keras</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># reset the colors</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">makeRoc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_hls</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">),</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)]</span>
<span class="kn">from</span> <span class="nn">matplotlib.legend</span> <span class="kn">import</span> <span class="n">Legend</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">Legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;keras&quot;</span><span class="p">,</span> <span class="s2">&quot;hls4ml&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">leg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing HLS project
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Keras  Accuracy: 0.7516506024096385
hls4ml Accuracy: 0.5122831325301205
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fe82b00ad50&gt;
</pre></div>
</div>
<img alt="_images/2.2_advanced_config_10_4.png" src="_images/2.2_advanced_config_10_4.png" />
</div>
</div>
<p>Not good at all! Lets see if we can figure out how to create a model that will work at these lower precisions.</p>
<p>The first thing we can try is adding some regularizers. This will penalize the model for using large weights, which can help to reduce the number of bits that are necessary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">BatchNormalization</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.regularizers</span> <span class="kn">import</span> <span class="n">l1</span>
<span class="kn">from</span> <span class="nn">callbacks</span> <span class="kn">import</span> <span class="n">all_callbacks</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">Dense</span><span class="p">(</span>
        <span class="mi">64</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fc1&quot;</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;lecun_uniform&quot;</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">l1</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;relu1&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">Dense</span><span class="p">(</span>
        <span class="mi">32</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fc2&quot;</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;lecun_uniform&quot;</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">l1</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;relu2&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">Dense</span><span class="p">(</span>
        <span class="mi">32</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;fc3&quot;</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;lecun_uniform&quot;</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">l1</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;relu3&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">Dense</span><span class="p">(</span>
        <span class="mi">5</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>
        <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">&quot;lecun_uniform&quot;</span><span class="p">,</span>
        <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">l1</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Activation</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">train</span><span class="p">:</span>
    <span class="n">adam</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="n">optimizer</span><span class="o">=</span><span class="n">adam</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">all_callbacks</span><span class="p">(</span>
        <span class="n">stop_patience</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="n">lr_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">lr_patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">lr_epsilon</span><span class="o">=</span><span class="mf">0.000001</span><span class="p">,</span>
        <span class="n">lr_cooldown</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">lr_minimum</span><span class="o">=</span><span class="mf">0.0000001</span><span class="p">,</span>
        <span class="n">outputDir</span><span class="o">=</span><span class="s2">&quot;model_2&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">X_train_val</span><span class="p">,</span>
        <span class="n">y_train_val</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="o">.</span><span class="n">callbacks</span><span class="p">,</span>
    <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;model_2/KERAS_check_best_model.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:tensorflow:`epsilon` argument is deprecated and will be removed, use `min_delta` instead.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/30
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/keras/optimizers/optimizer_v2/adam.py:114: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super().__init__(name, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 4:26 - loss: 1.7324 - accuracy: 0.3154
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0025s vs `on_train_batch_end` time: 0.0028s). Check your callbacks.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 20/487 [&gt;.............................] - ETA: 1s - loss: 1.7065 - accuracy: 0.3165  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 41/487 [=&gt;............................] - ETA: 1s - loss: 1.6752 - accuracy: 0.3172
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 62/487 [==&gt;...........................] - ETA: 1s - loss: 1.6461 - accuracy: 0.3209
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 83/487 [====&gt;.........................] - ETA: 1s - loss: 1.6193 - accuracy: 0.3268
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
105/487 [=====&gt;........................] - ETA: 0s - loss: 1.5933 - accuracy: 0.3354
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
126/487 [======&gt;.......................] - ETA: 0s - loss: 1.5710 - accuracy: 0.3472
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
147/487 [========&gt;.....................] - ETA: 0s - loss: 1.5502 - accuracy: 0.3624
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
169/487 [=========&gt;....................] - ETA: 0s - loss: 1.5290 - accuracy: 0.3784
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
191/487 [==========&gt;...................] - ETA: 0s - loss: 1.5097 - accuracy: 0.3918
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
213/487 [============&gt;.................] - ETA: 0s - loss: 1.4910 - accuracy: 0.4036
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
235/487 [=============&gt;................] - ETA: 0s - loss: 1.4731 - accuracy: 0.4141
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
256/487 [==============&gt;...............] - ETA: 0s - loss: 1.4566 - accuracy: 0.4232
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
276/487 [================&gt;.............] - ETA: 0s - loss: 1.4421 - accuracy: 0.4316
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
296/487 [=================&gt;............] - ETA: 0s - loss: 1.4282 - accuracy: 0.4393
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
316/487 [==================&gt;...........] - ETA: 0s - loss: 1.4153 - accuracy: 0.4470
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
337/487 [===================&gt;..........] - ETA: 0s - loss: 1.4029 - accuracy: 0.4544
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
358/487 [=====================&gt;........] - ETA: 0s - loss: 1.3910 - accuracy: 0.4616
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
379/487 [======================&gt;.......] - ETA: 0s - loss: 1.3797 - accuracy: 0.4682
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
400/487 [=======================&gt;......] - ETA: 0s - loss: 1.3694 - accuracy: 0.4747
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
421/487 [========================&gt;.....] - ETA: 0s - loss: 1.3595 - accuracy: 0.4808
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
443/487 [==========================&gt;...] - ETA: 0s - loss: 1.3499 - accuracy: 0.4869
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
464/487 [===========================&gt;..] - ETA: 0s - loss: 1.3410 - accuracy: 0.4927
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
485/487 [============================&gt;.] - ETA: 0s - loss: 1.3326 - accuracy: 0.4985
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 1: val_loss improved from inf to 1.14627, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1: val_loss improved from inf to 1.14627, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 2s 3ms/step - loss: 1.3320 - accuracy: 0.4989 - val_loss: 1.1463 - val_accuracy: 0.6224 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 1.1266 - accuracy: 0.6357
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 22/487 [&gt;.............................] - ETA: 1s - loss: 1.1418 - accuracy: 0.6254
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 43/487 [=&gt;............................] - ETA: 1s - loss: 1.1371 - accuracy: 0.6275
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/487 [===&gt;..........................] - ETA: 1s - loss: 1.1340 - accuracy: 0.6293
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/487 [====&gt;.........................] - ETA: 0s - loss: 1.1307 - accuracy: 0.6318
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/487 [=====&gt;........................] - ETA: 0s - loss: 1.1270 - accuracy: 0.6346
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
130/487 [=======&gt;......................] - ETA: 0s - loss: 1.1220 - accuracy: 0.6373
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
152/487 [========&gt;.....................] - ETA: 0s - loss: 1.1173 - accuracy: 0.6398
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
173/487 [=========&gt;....................] - ETA: 0s - loss: 1.1135 - accuracy: 0.6412
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
194/487 [==========&gt;...................] - ETA: 0s - loss: 1.1093 - accuracy: 0.6427
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
215/487 [============&gt;.................] - ETA: 0s - loss: 1.1056 - accuracy: 0.6445
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
236/487 [=============&gt;................] - ETA: 0s - loss: 1.1029 - accuracy: 0.6459
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
257/487 [==============&gt;...............] - ETA: 0s - loss: 1.0992 - accuracy: 0.6476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
278/487 [================&gt;.............] - ETA: 0s - loss: 1.0965 - accuracy: 0.6488
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
299/487 [=================&gt;............] - ETA: 0s - loss: 1.0936 - accuracy: 0.6503
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
320/487 [==================&gt;...........] - ETA: 0s - loss: 1.0912 - accuracy: 0.6515
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
341/487 [====================&gt;.........] - ETA: 0s - loss: 1.0885 - accuracy: 0.6527
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
362/487 [=====================&gt;........] - ETA: 0s - loss: 1.0852 - accuracy: 0.6540
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
383/487 [======================&gt;.......] - ETA: 0s - loss: 1.0824 - accuracy: 0.6551
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
405/487 [=======================&gt;......] - ETA: 0s - loss: 1.0798 - accuracy: 0.6559
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
427/487 [=========================&gt;....] - ETA: 0s - loss: 1.0772 - accuracy: 0.6568
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
448/487 [==========================&gt;...] - ETA: 0s - loss: 1.0740 - accuracy: 0.6581
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
469/487 [===========================&gt;..] - ETA: 0s - loss: 1.0715 - accuracy: 0.6589
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 2: val_loss improved from 1.14627 to 1.01507, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2: val_loss improved from 1.14627 to 1.01507, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 1.0694 - accuracy: 0.6598 - val_loss: 1.0151 - val_accuracy: 0.6797 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.9536 - accuracy: 0.6982
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 22/487 [&gt;.............................] - ETA: 1s - loss: 1.0039 - accuracy: 0.6826
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 43/487 [=&gt;............................] - ETA: 1s - loss: 1.0104 - accuracy: 0.6807
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/487 [===&gt;..........................] - ETA: 1s - loss: 1.0081 - accuracy: 0.6812
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/487 [====&gt;.........................] - ETA: 0s - loss: 1.0069 - accuracy: 0.6819
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
107/487 [=====&gt;........................] - ETA: 0s - loss: 1.0061 - accuracy: 0.6820
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
129/487 [======&gt;.......................] - ETA: 0s - loss: 1.0044 - accuracy: 0.6826
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
151/487 [========&gt;.....................] - ETA: 0s - loss: 1.0040 - accuracy: 0.6824
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
172/487 [=========&gt;....................] - ETA: 0s - loss: 1.0013 - accuracy: 0.6835
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
194/487 [==========&gt;...................] - ETA: 0s - loss: 0.9996 - accuracy: 0.6836
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
216/487 [============&gt;.................] - ETA: 0s - loss: 0.9973 - accuracy: 0.6847
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
238/487 [=============&gt;................] - ETA: 0s - loss: 0.9958 - accuracy: 0.6853
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
260/487 [===============&gt;..............] - ETA: 0s - loss: 0.9941 - accuracy: 0.6858
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
282/487 [================&gt;.............] - ETA: 0s - loss: 0.9921 - accuracy: 0.6865
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
304/487 [=================&gt;............] - ETA: 0s - loss: 0.9905 - accuracy: 0.6871
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
326/487 [===================&gt;..........] - ETA: 0s - loss: 0.9891 - accuracy: 0.6876
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
348/487 [====================&gt;.........] - ETA: 0s - loss: 0.9879 - accuracy: 0.6879
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
370/487 [=====================&gt;........] - ETA: 0s - loss: 0.9865 - accuracy: 0.6883
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
392/487 [=======================&gt;......] - ETA: 0s - loss: 0.9849 - accuracy: 0.6889
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
414/487 [========================&gt;.....] - ETA: 0s - loss: 0.9837 - accuracy: 0.6894
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
436/487 [=========================&gt;....] - ETA: 0s - loss: 0.9825 - accuracy: 0.6896
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
457/487 [===========================&gt;..] - ETA: 0s - loss: 0.9815 - accuracy: 0.6900
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
478/487 [============================&gt;.] - ETA: 0s - loss: 0.9801 - accuracy: 0.6906
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 3: val_loss improved from 1.01507 to 0.95476, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3: val_loss improved from 1.01507 to 0.95476, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.9792 - accuracy: 0.6909 - val_loss: 0.9548 - val_accuracy: 0.6995 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.9658 - accuracy: 0.6826
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.9487 - accuracy: 0.6996
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/487 [=&gt;............................] - ETA: 1s - loss: 0.9512 - accuracy: 0.7005
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/487 [===&gt;..........................] - ETA: 1s - loss: 0.9493 - accuracy: 0.7017
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/487 [====&gt;.........................] - ETA: 0s - loss: 0.9504 - accuracy: 0.7012
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/487 [=====&gt;........................] - ETA: 0s - loss: 0.9485 - accuracy: 0.7016
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
130/487 [=======&gt;......................] - ETA: 0s - loss: 0.9464 - accuracy: 0.7025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
152/487 [========&gt;.....................] - ETA: 0s - loss: 0.9436 - accuracy: 0.7038
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
174/487 [=========&gt;....................] - ETA: 0s - loss: 0.9423 - accuracy: 0.7043
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
195/487 [===========&gt;..................] - ETA: 0s - loss: 0.9418 - accuracy: 0.7049
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
216/487 [============&gt;.................] - ETA: 0s - loss: 0.9416 - accuracy: 0.7048
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
237/487 [=============&gt;................] - ETA: 0s - loss: 0.9398 - accuracy: 0.7055
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
258/487 [==============&gt;...............] - ETA: 0s - loss: 0.9395 - accuracy: 0.7057
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
280/487 [================&gt;.............] - ETA: 0s - loss: 0.9386 - accuracy: 0.7057
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
301/487 [=================&gt;............] - ETA: 0s - loss: 0.9370 - accuracy: 0.7059
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/487 [==================&gt;...........] - ETA: 0s - loss: 0.9362 - accuracy: 0.7062
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
345/487 [====================&gt;.........] - ETA: 0s - loss: 0.9354 - accuracy: 0.7062
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
366/487 [=====================&gt;........] - ETA: 0s - loss: 0.9344 - accuracy: 0.7063
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
388/487 [======================&gt;.......] - ETA: 0s - loss: 0.9333 - accuracy: 0.7067
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
410/487 [========================&gt;.....] - ETA: 0s - loss: 0.9328 - accuracy: 0.7067
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
432/487 [=========================&gt;....] - ETA: 0s - loss: 0.9321 - accuracy: 0.7068
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
453/487 [==========================&gt;...] - ETA: 0s - loss: 0.9314 - accuracy: 0.7070
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
474/487 [============================&gt;.] - ETA: 0s - loss: 0.9299 - accuracy: 0.7077
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 4: val_loss improved from 0.95476 to 0.91388, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4: val_loss improved from 0.95476 to 0.91388, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.9294 - accuracy: 0.7078 - val_loss: 0.9139 - val_accuracy: 0.7124 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 2s - loss: 0.9179 - accuracy: 0.7100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 22/487 [&gt;.............................] - ETA: 1s - loss: 0.9147 - accuracy: 0.7108
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 42/487 [=&gt;............................] - ETA: 1s - loss: 0.9116 - accuracy: 0.7116
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 62/487 [==&gt;...........................] - ETA: 1s - loss: 0.9096 - accuracy: 0.7127
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 83/487 [====&gt;.........................] - ETA: 0s - loss: 0.9096 - accuracy: 0.7131
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
104/487 [=====&gt;........................] - ETA: 0s - loss: 0.9074 - accuracy: 0.7143
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
125/487 [======&gt;.......................] - ETA: 0s - loss: 0.9068 - accuracy: 0.7144
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
145/487 [=======&gt;......................] - ETA: 0s - loss: 0.9051 - accuracy: 0.7147
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
166/487 [=========&gt;....................] - ETA: 0s - loss: 0.9055 - accuracy: 0.7145
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
188/487 [==========&gt;...................] - ETA: 0s - loss: 0.9036 - accuracy: 0.7150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
210/487 [===========&gt;..................] - ETA: 0s - loss: 0.9030 - accuracy: 0.7152
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
232/487 [=============&gt;................] - ETA: 0s - loss: 0.9026 - accuracy: 0.7154
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
254/487 [==============&gt;...............] - ETA: 0s - loss: 0.9027 - accuracy: 0.7150
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
276/487 [================&gt;.............] - ETA: 0s - loss: 0.9015 - accuracy: 0.7151
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
298/487 [=================&gt;............] - ETA: 0s - loss: 0.9005 - accuracy: 0.7155
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
319/487 [==================&gt;...........] - ETA: 0s - loss: 0.8993 - accuracy: 0.7160
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
340/487 [===================&gt;..........] - ETA: 0s - loss: 0.8986 - accuracy: 0.7164
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
362/487 [=====================&gt;........] - ETA: 0s - loss: 0.8977 - accuracy: 0.7166
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
383/487 [======================&gt;.......] - ETA: 0s - loss: 0.8978 - accuracy: 0.7165
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
405/487 [=======================&gt;......] - ETA: 0s - loss: 0.8971 - accuracy: 0.7168
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
426/487 [=========================&gt;....] - ETA: 0s - loss: 0.8971 - accuracy: 0.7168
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
447/487 [==========================&gt;...] - ETA: 0s - loss: 0.8964 - accuracy: 0.7169
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
467/487 [===========================&gt;..] - ETA: 0s - loss: 0.8956 - accuracy: 0.7170
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
486/487 [============================&gt;.] - ETA: 0s - loss: 0.8947 - accuracy: 0.7174
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 5: val_loss improved from 0.91388 to 0.88526, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5: val_loss improved from 0.91388 to 0.88526, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8947 - accuracy: 0.7174 - val_loss: 0.8853 - val_accuracy: 0.7198 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.9286 - accuracy: 0.7158
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8791 - accuracy: 0.7197
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/487 [=&gt;............................] - ETA: 1s - loss: 0.8787 - accuracy: 0.7192
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 0s - loss: 0.8818 - accuracy: 0.7189
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/487 [====&gt;.........................] - ETA: 0s - loss: 0.8818 - accuracy: 0.7192
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
109/487 [=====&gt;........................] - ETA: 0s - loss: 0.8801 - accuracy: 0.7199
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
131/487 [=======&gt;......................] - ETA: 0s - loss: 0.8800 - accuracy: 0.7200
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
153/487 [========&gt;.....................] - ETA: 0s - loss: 0.8785 - accuracy: 0.7204
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
176/487 [=========&gt;....................] - ETA: 0s - loss: 0.8777 - accuracy: 0.7207
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
198/487 [===========&gt;..................] - ETA: 0s - loss: 0.8772 - accuracy: 0.7210
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
219/487 [============&gt;.................] - ETA: 0s - loss: 0.8771 - accuracy: 0.7208
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
240/487 [=============&gt;................] - ETA: 0s - loss: 0.8769 - accuracy: 0.7209
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
261/487 [===============&gt;..............] - ETA: 0s - loss: 0.8770 - accuracy: 0.7207
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
282/487 [================&gt;.............] - ETA: 0s - loss: 0.8760 - accuracy: 0.7212
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
303/487 [=================&gt;............] - ETA: 0s - loss: 0.8757 - accuracy: 0.7212
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
324/487 [==================&gt;...........] - ETA: 0s - loss: 0.8748 - accuracy: 0.7215
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
344/487 [====================&gt;.........] - ETA: 0s - loss: 0.8745 - accuracy: 0.7217
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
365/487 [=====================&gt;........] - ETA: 0s - loss: 0.8734 - accuracy: 0.7219
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
386/487 [======================&gt;.......] - ETA: 0s - loss: 0.8733 - accuracy: 0.7218
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
407/487 [========================&gt;.....] - ETA: 0s - loss: 0.8730 - accuracy: 0.7219
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
429/487 [=========================&gt;....] - ETA: 0s - loss: 0.8724 - accuracy: 0.7220
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
451/487 [==========================&gt;...] - ETA: 0s - loss: 0.8716 - accuracy: 0.7222
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
472/487 [============================&gt;.] - ETA: 0s - loss: 0.8710 - accuracy: 0.7224
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 6: val_loss improved from 0.88526 to 0.86540, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6: val_loss improved from 0.88526 to 0.86540, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 6: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8705 - accuracy: 0.7225 - val_loss: 0.8654 - val_accuracy: 0.7244 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 2s - loss: 0.8517 - accuracy: 0.7354
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8570 - accuracy: 0.7278
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.8597 - accuracy: 0.7253
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 1s - loss: 0.8621 - accuracy: 0.7252
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/487 [====&gt;.........................] - ETA: 0s - loss: 0.8614 - accuracy: 0.7253
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
109/487 [=====&gt;........................] - ETA: 0s - loss: 0.8624 - accuracy: 0.7243
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
130/487 [=======&gt;......................] - ETA: 0s - loss: 0.8630 - accuracy: 0.7241
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
151/487 [========&gt;.....................] - ETA: 0s - loss: 0.8612 - accuracy: 0.7248
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
172/487 [=========&gt;....................] - ETA: 0s - loss: 0.8605 - accuracy: 0.7249
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
193/487 [==========&gt;...................] - ETA: 0s - loss: 0.8601 - accuracy: 0.7249
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
215/487 [============&gt;.................] - ETA: 0s - loss: 0.8599 - accuracy: 0.7248
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
237/487 [=============&gt;................] - ETA: 0s - loss: 0.8590 - accuracy: 0.7252
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
258/487 [==============&gt;...............] - ETA: 0s - loss: 0.8584 - accuracy: 0.7253
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
279/487 [================&gt;.............] - ETA: 0s - loss: 0.8584 - accuracy: 0.7250
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
301/487 [=================&gt;............] - ETA: 0s - loss: 0.8577 - accuracy: 0.7253
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/487 [==================&gt;...........] - ETA: 0s - loss: 0.8565 - accuracy: 0.7257
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
345/487 [====================&gt;.........] - ETA: 0s - loss: 0.8562 - accuracy: 0.7256
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
367/487 [=====================&gt;........] - ETA: 0s - loss: 0.8554 - accuracy: 0.7258
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
389/487 [======================&gt;.......] - ETA: 0s - loss: 0.8552 - accuracy: 0.7260
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
411/487 [========================&gt;.....] - ETA: 0s - loss: 0.8544 - accuracy: 0.7263
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
433/487 [=========================&gt;....] - ETA: 0s - loss: 0.8541 - accuracy: 0.7264
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
455/487 [===========================&gt;..] - ETA: 0s - loss: 0.8536 - accuracy: 0.7264
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
476/487 [============================&gt;.] - ETA: 0s - loss: 0.8534 - accuracy: 0.7265
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 7: val_loss improved from 0.86540 to 0.85146, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7: val_loss improved from 0.86540 to 0.85146, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 7: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8535 - accuracy: 0.7264 - val_loss: 0.8515 - val_accuracy: 0.7268 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 2s - loss: 0.8695 - accuracy: 0.7080
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8460 - accuracy: 0.7266
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.8422 - accuracy: 0.7290
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 1s - loss: 0.8415 - accuracy: 0.7292
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/487 [====&gt;.........................] - ETA: 0s - loss: 0.8424 - accuracy: 0.7289
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/487 [=====&gt;........................] - ETA: 0s - loss: 0.8416 - accuracy: 0.7292
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
128/487 [======&gt;.......................] - ETA: 0s - loss: 0.8421 - accuracy: 0.7291
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
149/487 [========&gt;.....................] - ETA: 0s - loss: 0.8418 - accuracy: 0.7289
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
170/487 [=========&gt;....................] - ETA: 0s - loss: 0.8421 - accuracy: 0.7288
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
192/487 [==========&gt;...................] - ETA: 0s - loss: 0.8408 - accuracy: 0.7295
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
214/487 [============&gt;.................] - ETA: 0s - loss: 0.8424 - accuracy: 0.7293
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
236/487 [=============&gt;................] - ETA: 0s - loss: 0.8425 - accuracy: 0.7290
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
258/487 [==============&gt;...............] - ETA: 0s - loss: 0.8431 - accuracy: 0.7287
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
279/487 [================&gt;.............] - ETA: 0s - loss: 0.8429 - accuracy: 0.7288
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
301/487 [=================&gt;............] - ETA: 0s - loss: 0.8427 - accuracy: 0.7289
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
322/487 [==================&gt;...........] - ETA: 0s - loss: 0.8424 - accuracy: 0.7290
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
344/487 [====================&gt;.........] - ETA: 0s - loss: 0.8427 - accuracy: 0.7290
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
365/487 [=====================&gt;........] - ETA: 0s - loss: 0.8422 - accuracy: 0.7291
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
386/487 [======================&gt;.......] - ETA: 0s - loss: 0.8417 - accuracy: 0.7293
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
407/487 [========================&gt;.....] - ETA: 0s - loss: 0.8407 - accuracy: 0.7295
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
428/487 [=========================&gt;....] - ETA: 0s - loss: 0.8410 - accuracy: 0.7293
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
450/487 [==========================&gt;...] - ETA: 0s - loss: 0.8406 - accuracy: 0.7294
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
472/487 [============================&gt;.] - ETA: 0s - loss: 0.8406 - accuracy: 0.7294
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 8: val_loss improved from 0.85146 to 0.84035, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8: val_loss improved from 0.85146 to 0.84035, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 8: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8407 - accuracy: 0.7293 - val_loss: 0.8404 - val_accuracy: 0.7300 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.8137 - accuracy: 0.7363
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8410 - accuracy: 0.7288
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.8361 - accuracy: 0.7299
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 0s - loss: 0.8379 - accuracy: 0.7295
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/487 [====&gt;.........................] - ETA: 0s - loss: 0.8373 - accuracy: 0.7304
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/487 [=====&gt;........................] - ETA: 0s - loss: 0.8378 - accuracy: 0.7300
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
129/487 [======&gt;.......................] - ETA: 0s - loss: 0.8361 - accuracy: 0.7305
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
150/487 [========&gt;.....................] - ETA: 0s - loss: 0.8357 - accuracy: 0.7305
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
171/487 [=========&gt;....................] - ETA: 0s - loss: 0.8344 - accuracy: 0.7311
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
193/487 [==========&gt;...................] - ETA: 0s - loss: 0.8340 - accuracy: 0.7311
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
215/487 [============&gt;.................] - ETA: 0s - loss: 0.8338 - accuracy: 0.7310
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
237/487 [=============&gt;................] - ETA: 0s - loss: 0.8336 - accuracy: 0.7312
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
259/487 [==============&gt;...............] - ETA: 0s - loss: 0.8331 - accuracy: 0.7314
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
281/487 [================&gt;.............] - ETA: 0s - loss: 0.8332 - accuracy: 0.7311
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
303/487 [=================&gt;............] - ETA: 0s - loss: 0.8320 - accuracy: 0.7315
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
325/487 [===================&gt;..........] - ETA: 0s - loss: 0.8323 - accuracy: 0.7313
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
347/487 [====================&gt;.........] - ETA: 0s - loss: 0.8316 - accuracy: 0.7317
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
369/487 [=====================&gt;........] - ETA: 0s - loss: 0.8315 - accuracy: 0.7315
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
391/487 [=======================&gt;......] - ETA: 0s - loss: 0.8315 - accuracy: 0.7314
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
413/487 [========================&gt;.....] - ETA: 0s - loss: 0.8314 - accuracy: 0.7315
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
435/487 [=========================&gt;....] - ETA: 0s - loss: 0.8317 - accuracy: 0.7315
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
457/487 [===========================&gt;..] - ETA: 0s - loss: 0.8317 - accuracy: 0.7314
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
478/487 [============================&gt;.] - ETA: 0s - loss: 0.8306 - accuracy: 0.7316
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 9: val_loss improved from 0.84035 to 0.83038, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9: val_loss improved from 0.84035 to 0.83038, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 9: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8303 - accuracy: 0.7317 - val_loss: 0.8304 - val_accuracy: 0.7317 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.8136 - accuracy: 0.7354
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8152 - accuracy: 0.7346
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/487 [=&gt;............................] - ETA: 1s - loss: 0.8188 - accuracy: 0.7335
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/487 [===&gt;..........................] - ETA: 1s - loss: 0.8183 - accuracy: 0.7347
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/487 [====&gt;.........................] - ETA: 0s - loss: 0.8186 - accuracy: 0.7345
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
107/487 [=====&gt;........................] - ETA: 0s - loss: 0.8197 - accuracy: 0.7345
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
128/487 [======&gt;.......................] - ETA: 0s - loss: 0.8203 - accuracy: 0.7345
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
149/487 [========&gt;.....................] - ETA: 0s - loss: 0.8222 - accuracy: 0.7335
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
171/487 [=========&gt;....................] - ETA: 0s - loss: 0.8220 - accuracy: 0.7337
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
193/487 [==========&gt;...................] - ETA: 0s - loss: 0.8226 - accuracy: 0.7337
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
214/487 [============&gt;.................] - ETA: 0s - loss: 0.8223 - accuracy: 0.7336
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
236/487 [=============&gt;................] - ETA: 0s - loss: 0.8216 - accuracy: 0.7340
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
258/487 [==============&gt;...............] - ETA: 0s - loss: 0.8213 - accuracy: 0.7339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
280/487 [================&gt;.............] - ETA: 0s - loss: 0.8219 - accuracy: 0.7339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
301/487 [=================&gt;............] - ETA: 0s - loss: 0.8217 - accuracy: 0.7341
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/487 [==================&gt;...........] - ETA: 0s - loss: 0.8220 - accuracy: 0.7339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
344/487 [====================&gt;.........] - ETA: 0s - loss: 0.8218 - accuracy: 0.7339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
365/487 [=====================&gt;........] - ETA: 0s - loss: 0.8216 - accuracy: 0.7339
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
386/487 [======================&gt;.......] - ETA: 0s - loss: 0.8215 - accuracy: 0.7341
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
407/487 [========================&gt;.....] - ETA: 0s - loss: 0.8211 - accuracy: 0.7341
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
428/487 [=========================&gt;....] - ETA: 0s - loss: 0.8213 - accuracy: 0.7340
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
450/487 [==========================&gt;...] - ETA: 0s - loss: 0.8216 - accuracy: 0.7340
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
472/487 [============================&gt;.] - ETA: 0s - loss: 0.8212 - accuracy: 0.7341
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 10: val_loss improved from 0.83038 to 0.82210, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10: val_loss improved from 0.83038 to 0.82210, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 10: saving model to model_2/KERAS_check_model_epoch10.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8212 - accuracy: 0.7340 - val_loss: 0.8221 - val_accuracy: 0.7342 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 2s - loss: 0.8513 - accuracy: 0.7275
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 22/487 [&gt;.............................] - ETA: 1s - loss: 0.8078 - accuracy: 0.7392
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 43/487 [=&gt;............................] - ETA: 1s - loss: 0.8145 - accuracy: 0.7362
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 64/487 [==&gt;...........................] - ETA: 1s - loss: 0.8140 - accuracy: 0.7365
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 85/487 [====&gt;.........................] - ETA: 0s - loss: 0.8134 - accuracy: 0.7375
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
106/487 [=====&gt;........................] - ETA: 0s - loss: 0.8122 - accuracy: 0.7374
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
128/487 [======&gt;.......................] - ETA: 0s - loss: 0.8125 - accuracy: 0.7373
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
149/487 [========&gt;.....................] - ETA: 0s - loss: 0.8117 - accuracy: 0.7376
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
170/487 [=========&gt;....................] - ETA: 0s - loss: 0.8113 - accuracy: 0.7375
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
191/487 [==========&gt;...................] - ETA: 0s - loss: 0.8116 - accuracy: 0.7373
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
212/487 [============&gt;.................] - ETA: 0s - loss: 0.8132 - accuracy: 0.7369
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
233/487 [=============&gt;................] - ETA: 0s - loss: 0.8132 - accuracy: 0.7370
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
255/487 [==============&gt;...............] - ETA: 0s - loss: 0.8141 - accuracy: 0.7369
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
276/487 [================&gt;.............] - ETA: 0s - loss: 0.8145 - accuracy: 0.7364
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
298/487 [=================&gt;............] - ETA: 0s - loss: 0.8141 - accuracy: 0.7362
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
319/487 [==================&gt;...........] - ETA: 0s - loss: 0.8145 - accuracy: 0.7360
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
339/487 [===================&gt;..........] - ETA: 0s - loss: 0.8141 - accuracy: 0.7360
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
359/487 [=====================&gt;........] - ETA: 0s - loss: 0.8143 - accuracy: 0.7360
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
380/487 [======================&gt;.......] - ETA: 0s - loss: 0.8148 - accuracy: 0.7358
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
401/487 [=======================&gt;......] - ETA: 0s - loss: 0.8147 - accuracy: 0.7358
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
422/487 [========================&gt;.....] - ETA: 0s - loss: 0.8138 - accuracy: 0.7361
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
443/487 [==========================&gt;...] - ETA: 0s - loss: 0.8135 - accuracy: 0.7362
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
464/487 [===========================&gt;..] - ETA: 0s - loss: 0.8133 - accuracy: 0.7362
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
485/487 [============================&gt;.] - ETA: 0s - loss: 0.8130 - accuracy: 0.7364
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 11: val_loss improved from 0.82210 to 0.81447, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11: val_loss improved from 0.82210 to 0.81447, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 11: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 2s 3ms/step - loss: 0.8130 - accuracy: 0.7363 - val_loss: 0.8145 - val_accuracy: 0.7361 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.8459 - accuracy: 0.7334
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 22/487 [&gt;.............................] - ETA: 1s - loss: 0.8237 - accuracy: 0.7318
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/487 [=&gt;............................] - ETA: 1s - loss: 0.8151 - accuracy: 0.7348
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 0s - loss: 0.8106 - accuracy: 0.7361
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 88/487 [====&gt;.........................] - ETA: 0s - loss: 0.8075 - accuracy: 0.7370
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
110/487 [=====&gt;........................] - ETA: 0s - loss: 0.8077 - accuracy: 0.7371
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
132/487 [=======&gt;......................] - ETA: 0s - loss: 0.8063 - accuracy: 0.7381
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
154/487 [========&gt;.....................] - ETA: 0s - loss: 0.8072 - accuracy: 0.7374
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
175/487 [=========&gt;....................] - ETA: 0s - loss: 0.8083 - accuracy: 0.7371
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
197/487 [===========&gt;..................] - ETA: 0s - loss: 0.8077 - accuracy: 0.7372
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
219/487 [============&gt;.................] - ETA: 0s - loss: 0.8080 - accuracy: 0.7376
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
241/487 [=============&gt;................] - ETA: 0s - loss: 0.8079 - accuracy: 0.7374
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
263/487 [===============&gt;..............] - ETA: 0s - loss: 0.8074 - accuracy: 0.7377
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
284/487 [================&gt;.............] - ETA: 0s - loss: 0.8066 - accuracy: 0.7380
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
305/487 [=================&gt;............] - ETA: 0s - loss: 0.8065 - accuracy: 0.7382
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
326/487 [===================&gt;..........] - ETA: 0s - loss: 0.8072 - accuracy: 0.7379
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
348/487 [====================&gt;.........] - ETA: 0s - loss: 0.8061 - accuracy: 0.7381
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
370/487 [=====================&gt;........] - ETA: 0s - loss: 0.8056 - accuracy: 0.7383
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
391/487 [=======================&gt;......] - ETA: 0s - loss: 0.8056 - accuracy: 0.7384
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
412/487 [========================&gt;.....] - ETA: 0s - loss: 0.8058 - accuracy: 0.7383
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
434/487 [=========================&gt;....] - ETA: 0s - loss: 0.8059 - accuracy: 0.7382
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
456/487 [===========================&gt;..] - ETA: 0s - loss: 0.8062 - accuracy: 0.7381
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
477/487 [============================&gt;.] - ETA: 0s - loss: 0.8057 - accuracy: 0.7381
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 12: val_loss improved from 0.81447 to 0.80775, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12: val_loss improved from 0.81447 to 0.80775, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 12: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.8057 - accuracy: 0.7381 - val_loss: 0.8078 - val_accuracy: 0.7385 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7902 - accuracy: 0.7422
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8032 - accuracy: 0.7406
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.8075 - accuracy: 0.7382
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 67/487 [===&gt;..........................] - ETA: 0s - loss: 0.8054 - accuracy: 0.7389
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 89/487 [====&gt;.........................] - ETA: 0s - loss: 0.8027 - accuracy: 0.7388
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
111/487 [=====&gt;........................] - ETA: 0s - loss: 0.8040 - accuracy: 0.7383
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
133/487 [=======&gt;......................] - ETA: 0s - loss: 0.8038 - accuracy: 0.7384
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
154/487 [========&gt;.....................] - ETA: 0s - loss: 0.8032 - accuracy: 0.7384
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
175/487 [=========&gt;....................] - ETA: 0s - loss: 0.8038 - accuracy: 0.7384
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
196/487 [===========&gt;..................] - ETA: 0s - loss: 0.8045 - accuracy: 0.7387
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
217/487 [============&gt;.................] - ETA: 0s - loss: 0.8037 - accuracy: 0.7392
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
238/487 [=============&gt;................] - ETA: 0s - loss: 0.8031 - accuracy: 0.7393
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
260/487 [===============&gt;..............] - ETA: 0s - loss: 0.8025 - accuracy: 0.7393
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
281/487 [================&gt;.............] - ETA: 0s - loss: 0.8016 - accuracy: 0.7394
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
302/487 [=================&gt;............] - ETA: 0s - loss: 0.8004 - accuracy: 0.7398
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/487 [==================&gt;...........] - ETA: 0s - loss: 0.7997 - accuracy: 0.7399
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
344/487 [====================&gt;.........] - ETA: 0s - loss: 0.7993 - accuracy: 0.7402
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
365/487 [=====================&gt;........] - ETA: 0s - loss: 0.7997 - accuracy: 0.7400
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
386/487 [======================&gt;.......] - ETA: 0s - loss: 0.8000 - accuracy: 0.7399
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
407/487 [========================&gt;.....] - ETA: 0s - loss: 0.7998 - accuracy: 0.7399
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
429/487 [=========================&gt;....] - ETA: 0s - loss: 0.7992 - accuracy: 0.7401
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
451/487 [==========================&gt;...] - ETA: 0s - loss: 0.7989 - accuracy: 0.7401
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
473/487 [============================&gt;.] - ETA: 0s - loss: 0.7992 - accuracy: 0.7402
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 13: val_loss improved from 0.80775 to 0.80149, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13: val_loss improved from 0.80775 to 0.80149, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 13: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 2s 3ms/step - loss: 0.7992 - accuracy: 0.7400 - val_loss: 0.8015 - val_accuracy: 0.7400 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7716 - accuracy: 0.7607
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.8036 - accuracy: 0.7405
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 44/487 [=&gt;............................] - ETA: 1s - loss: 0.8006 - accuracy: 0.7409
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/487 [===&gt;..........................] - ETA: 1s - loss: 0.7994 - accuracy: 0.7404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/487 [====&gt;.........................] - ETA: 0s - loss: 0.7965 - accuracy: 0.7409
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
107/487 [=====&gt;........................] - ETA: 0s - loss: 0.7995 - accuracy: 0.7399
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
129/487 [======&gt;.......................] - ETA: 0s - loss: 0.7984 - accuracy: 0.7404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
150/487 [========&gt;.....................] - ETA: 0s - loss: 0.7978 - accuracy: 0.7401
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
172/487 [=========&gt;....................] - ETA: 0s - loss: 0.7965 - accuracy: 0.7404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
193/487 [==========&gt;...................] - ETA: 0s - loss: 0.7970 - accuracy: 0.7403
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
215/487 [============&gt;.................] - ETA: 0s - loss: 0.7966 - accuracy: 0.7402
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
237/487 [=============&gt;................] - ETA: 0s - loss: 0.7963 - accuracy: 0.7404
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
258/487 [==============&gt;...............] - ETA: 0s - loss: 0.7959 - accuracy: 0.7405
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
280/487 [================&gt;.............] - ETA: 0s - loss: 0.7956 - accuracy: 0.7405
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
302/487 [=================&gt;............] - ETA: 0s - loss: 0.7946 - accuracy: 0.7408
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
324/487 [==================&gt;...........] - ETA: 0s - loss: 0.7941 - accuracy: 0.7412
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
346/487 [====================&gt;.........] - ETA: 0s - loss: 0.7939 - accuracy: 0.7411
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
366/487 [=====================&gt;........] - ETA: 0s - loss: 0.7943 - accuracy: 0.7410
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
388/487 [======================&gt;.......] - ETA: 0s - loss: 0.7942 - accuracy: 0.7413
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
410/487 [========================&gt;.....] - ETA: 0s - loss: 0.7941 - accuracy: 0.7412
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
432/487 [=========================&gt;....] - ETA: 0s - loss: 0.7943 - accuracy: 0.7412
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
454/487 [==========================&gt;...] - ETA: 0s - loss: 0.7935 - accuracy: 0.7415
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
475/487 [============================&gt;.] - ETA: 0s - loss: 0.7933 - accuracy: 0.7416
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 14: val_loss improved from 0.80149 to 0.79622, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14: val_loss improved from 0.80149 to 0.79622, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 14: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.7935 - accuracy: 0.7416 - val_loss: 0.7962 - val_accuracy: 0.7416 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7411 - accuracy: 0.7637
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.7879 - accuracy: 0.7444
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.7894 - accuracy: 0.7431
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 65/487 [===&gt;..........................] - ETA: 1s - loss: 0.7864 - accuracy: 0.7437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/487 [====&gt;.........................] - ETA: 0s - loss: 0.7886 - accuracy: 0.7425
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
107/487 [=====&gt;........................] - ETA: 0s - loss: 0.7904 - accuracy: 0.7421
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
129/487 [======&gt;.......................] - ETA: 0s - loss: 0.7915 - accuracy: 0.7421
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
151/487 [========&gt;.....................] - ETA: 0s - loss: 0.7901 - accuracy: 0.7426
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
173/487 [=========&gt;....................] - ETA: 0s - loss: 0.7902 - accuracy: 0.7422
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
194/487 [==========&gt;...................] - ETA: 0s - loss: 0.7890 - accuracy: 0.7426
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
215/487 [============&gt;.................] - ETA: 0s - loss: 0.7890 - accuracy: 0.7428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
236/487 [=============&gt;................] - ETA: 0s - loss: 0.7878 - accuracy: 0.7433
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
257/487 [==============&gt;...............] - ETA: 0s - loss: 0.7875 - accuracy: 0.7430
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
278/487 [================&gt;.............] - ETA: 0s - loss: 0.7882 - accuracy: 0.7429
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
299/487 [=================&gt;............] - ETA: 0s - loss: 0.7886 - accuracy: 0.7429
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
320/487 [==================&gt;...........] - ETA: 0s - loss: 0.7884 - accuracy: 0.7430
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
341/487 [====================&gt;.........] - ETA: 0s - loss: 0.7885 - accuracy: 0.7430
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
363/487 [=====================&gt;........] - ETA: 0s - loss: 0.7879 - accuracy: 0.7432
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
385/487 [======================&gt;.......] - ETA: 0s - loss: 0.7884 - accuracy: 0.7430
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
406/487 [========================&gt;.....] - ETA: 0s - loss: 0.7888 - accuracy: 0.7428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
428/487 [=========================&gt;....] - ETA: 0s - loss: 0.7884 - accuracy: 0.7429
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
450/487 [==========================&gt;...] - ETA: 0s - loss: 0.7889 - accuracy: 0.7428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
472/487 [============================&gt;.] - ETA: 0s - loss: 0.7889 - accuracy: 0.7428
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 15: val_loss improved from 0.79622 to 0.79153, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15: val_loss improved from 0.79622 to 0.79153, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 15: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.7885 - accuracy: 0.7430 - val_loss: 0.7915 - val_accuracy: 0.7427 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7957 - accuracy: 0.7451
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.7886 - accuracy: 0.7399
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.7859 - accuracy: 0.7415
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 1s - loss: 0.7893 - accuracy: 0.7411
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/487 [====&gt;.........................] - ETA: 0s - loss: 0.7877 - accuracy: 0.7420
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
109/487 [=====&gt;........................] - ETA: 0s - loss: 0.7855 - accuracy: 0.7436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
131/487 [=======&gt;......................] - ETA: 0s - loss: 0.7860 - accuracy: 0.7433
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
153/487 [========&gt;.....................] - ETA: 0s - loss: 0.7853 - accuracy: 0.7437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
174/487 [=========&gt;....................] - ETA: 0s - loss: 0.7852 - accuracy: 0.7437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
195/487 [===========&gt;..................] - ETA: 0s - loss: 0.7853 - accuracy: 0.7436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
216/487 [============&gt;.................] - ETA: 0s - loss: 0.7858 - accuracy: 0.7434
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
237/487 [=============&gt;................] - ETA: 0s - loss: 0.7854 - accuracy: 0.7436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
259/487 [==============&gt;...............] - ETA: 0s - loss: 0.7854 - accuracy: 0.7437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
280/487 [================&gt;.............] - ETA: 0s - loss: 0.7856 - accuracy: 0.7437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
302/487 [=================&gt;............] - ETA: 0s - loss: 0.7859 - accuracy: 0.7435
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/487 [==================&gt;...........] - ETA: 0s - loss: 0.7858 - accuracy: 0.7434
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
345/487 [====================&gt;.........] - ETA: 0s - loss: 0.7858 - accuracy: 0.7434
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
367/487 [=====================&gt;........] - ETA: 0s - loss: 0.7852 - accuracy: 0.7436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
389/487 [======================&gt;.......] - ETA: 0s - loss: 0.7849 - accuracy: 0.7438
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
410/487 [========================&gt;.....] - ETA: 0s - loss: 0.7849 - accuracy: 0.7438
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
431/487 [=========================&gt;....] - ETA: 0s - loss: 0.7847 - accuracy: 0.7439
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
453/487 [==========================&gt;...] - ETA: 0s - loss: 0.7845 - accuracy: 0.7441
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
475/487 [============================&gt;.] - ETA: 0s - loss: 0.7845 - accuracy: 0.7441
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 16: val_loss improved from 0.79153 to 0.78753, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16: val_loss improved from 0.79153 to 0.78753, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 16: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 2s 3ms/step - loss: 0.7843 - accuracy: 0.7442 - val_loss: 0.7875 - val_accuracy: 0.7437 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7510 - accuracy: 0.7529
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 22/487 [&gt;.............................] - ETA: 1s - loss: 0.7756 - accuracy: 0.7476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 42/487 [=&gt;............................] - ETA: 1s - loss: 0.7779 - accuracy: 0.7459
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 63/487 [==&gt;...........................] - ETA: 1s - loss: 0.7813 - accuracy: 0.7443
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 85/487 [====&gt;.........................] - ETA: 0s - loss: 0.7805 - accuracy: 0.7448
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
107/487 [=====&gt;........................] - ETA: 0s - loss: 0.7819 - accuracy: 0.7443
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
129/487 [======&gt;.......................] - ETA: 0s - loss: 0.7820 - accuracy: 0.7440
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
151/487 [========&gt;.....................] - ETA: 0s - loss: 0.7831 - accuracy: 0.7441
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
173/487 [=========&gt;....................] - ETA: 0s - loss: 0.7824 - accuracy: 0.7444
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
195/487 [===========&gt;..................] - ETA: 0s - loss: 0.7828 - accuracy: 0.7443
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
217/487 [============&gt;.................] - ETA: 0s - loss: 0.7821 - accuracy: 0.7447
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
238/487 [=============&gt;................] - ETA: 0s - loss: 0.7818 - accuracy: 0.7449
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
259/487 [==============&gt;...............] - ETA: 0s - loss: 0.7809 - accuracy: 0.7452
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
281/487 [================&gt;.............] - ETA: 0s - loss: 0.7810 - accuracy: 0.7452
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
302/487 [=================&gt;............] - ETA: 0s - loss: 0.7808 - accuracy: 0.7453
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/487 [==================&gt;...........] - ETA: 0s - loss: 0.7803 - accuracy: 0.7455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
344/487 [====================&gt;.........] - ETA: 0s - loss: 0.7806 - accuracy: 0.7454
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
365/487 [=====================&gt;........] - ETA: 0s - loss: 0.7808 - accuracy: 0.7455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
386/487 [======================&gt;.......] - ETA: 0s - loss: 0.7809 - accuracy: 0.7455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
407/487 [========================&gt;.....] - ETA: 0s - loss: 0.7805 - accuracy: 0.7455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
428/487 [=========================&gt;....] - ETA: 0s - loss: 0.7808 - accuracy: 0.7453
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
449/487 [==========================&gt;...] - ETA: 0s - loss: 0.7802 - accuracy: 0.7455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
470/487 [===========================&gt;..] - ETA: 0s - loss: 0.7805 - accuracy: 0.7453
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 17: val_loss improved from 0.78753 to 0.78392, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17: val_loss improved from 0.78753 to 0.78392, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 17: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.7806 - accuracy: 0.7453 - val_loss: 0.7839 - val_accuracy: 0.7448 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7923 - accuracy: 0.7295
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.7902 - accuracy: 0.7408
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.7863 - accuracy: 0.7411
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 0s - loss: 0.7842 - accuracy: 0.7422
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/487 [====&gt;.........................] - ETA: 0s - loss: 0.7819 - accuracy: 0.7437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
108/487 [=====&gt;........................] - ETA: 0s - loss: 0.7815 - accuracy: 0.7436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
128/487 [======&gt;.......................] - ETA: 0s - loss: 0.7789 - accuracy: 0.7451
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
149/487 [========&gt;.....................] - ETA: 0s - loss: 0.7777 - accuracy: 0.7460
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
170/487 [=========&gt;....................] - ETA: 0s - loss: 0.7789 - accuracy: 0.7457
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
191/487 [==========&gt;...................] - ETA: 0s - loss: 0.7788 - accuracy: 0.7459
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
212/487 [============&gt;.................] - ETA: 0s - loss: 0.7787 - accuracy: 0.7460
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
234/487 [=============&gt;................] - ETA: 0s - loss: 0.7774 - accuracy: 0.7465
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
255/487 [==============&gt;...............] - ETA: 0s - loss: 0.7776 - accuracy: 0.7465
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
276/487 [================&gt;.............] - ETA: 0s - loss: 0.7778 - accuracy: 0.7464
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
297/487 [=================&gt;............] - ETA: 0s - loss: 0.7784 - accuracy: 0.7462
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
318/487 [==================&gt;...........] - ETA: 0s - loss: 0.7785 - accuracy: 0.7460
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
339/487 [===================&gt;..........] - ETA: 0s - loss: 0.7795 - accuracy: 0.7456
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
361/487 [=====================&gt;........] - ETA: 0s - loss: 0.7793 - accuracy: 0.7454
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
382/487 [======================&gt;.......] - ETA: 0s - loss: 0.7793 - accuracy: 0.7455
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
403/487 [=======================&gt;......] - ETA: 0s - loss: 0.7785 - accuracy: 0.7458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
424/487 [=========================&gt;....] - ETA: 0s - loss: 0.7786 - accuracy: 0.7459
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
445/487 [==========================&gt;...] - ETA: 0s - loss: 0.7781 - accuracy: 0.7461
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
467/487 [===========================&gt;..] - ETA: 0s - loss: 0.7776 - accuracy: 0.7462
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
486/487 [============================&gt;.] - ETA: 0s - loss: 0.7773 - accuracy: 0.7463
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 18: val_loss improved from 0.78392 to 0.78110, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18: val_loss improved from 0.78392 to 0.78110, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 18: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.7773 - accuracy: 0.7463 - val_loss: 0.7811 - val_accuracy: 0.7453 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7607 - accuracy: 0.7539
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.7791 - accuracy: 0.7447
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.7778 - accuracy: 0.7457
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/487 [===&gt;..........................] - ETA: 0s - loss: 0.7739 - accuracy: 0.7467
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 88/487 [====&gt;.........................] - ETA: 0s - loss: 0.7757 - accuracy: 0.7452
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
110/487 [=====&gt;........................] - ETA: 0s - loss: 0.7756 - accuracy: 0.7458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
132/487 [=======&gt;......................] - ETA: 0s - loss: 0.7761 - accuracy: 0.7459
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
154/487 [========&gt;.....................] - ETA: 0s - loss: 0.7765 - accuracy: 0.7457
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
176/487 [=========&gt;....................] - ETA: 0s - loss: 0.7758 - accuracy: 0.7460
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
198/487 [===========&gt;..................] - ETA: 0s - loss: 0.7768 - accuracy: 0.7458
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
220/487 [============&gt;.................] - ETA: 0s - loss: 0.7757 - accuracy: 0.7461
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
242/487 [=============&gt;................] - ETA: 0s - loss: 0.7754 - accuracy: 0.7465
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
264/487 [===============&gt;..............] - ETA: 0s - loss: 0.7748 - accuracy: 0.7468
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
286/487 [================&gt;.............] - ETA: 0s - loss: 0.7746 - accuracy: 0.7469
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
308/487 [=================&gt;............] - ETA: 0s - loss: 0.7743 - accuracy: 0.7470
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
329/487 [===================&gt;..........] - ETA: 0s - loss: 0.7745 - accuracy: 0.7470
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
351/487 [====================&gt;.........] - ETA: 0s - loss: 0.7737 - accuracy: 0.7472
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
373/487 [=====================&gt;........] - ETA: 0s - loss: 0.7739 - accuracy: 0.7471
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
394/487 [=======================&gt;......] - ETA: 0s - loss: 0.7744 - accuracy: 0.7468
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
416/487 [========================&gt;.....] - ETA: 0s - loss: 0.7748 - accuracy: 0.7469
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
438/487 [=========================&gt;....] - ETA: 0s - loss: 0.7745 - accuracy: 0.7469
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
460/487 [===========================&gt;..] - ETA: 0s - loss: 0.7747 - accuracy: 0.7469
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
481/487 [============================&gt;.] - ETA: 0s - loss: 0.7745 - accuracy: 0.7470
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks***
saving losses to model_2/losses.log

Epoch 19: val_loss improved from 0.78110 to 0.77818, saving model to model_2/KERAS_check_best_model.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19: val_loss improved from 0.78110 to 0.77818, saving model to model_2/KERAS_check_best_model_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19: saving model to model_2/KERAS_check_model_last.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 19: saving model to model_2/KERAS_check_model_last_weights.h5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>***callbacks end***


487/487 [==============================] - 1s 3ms/step - loss: 0.7743 - accuracy: 0.7471 - val_loss: 0.7782 - val_accuracy: 0.7459 - lr: 1.0000e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 20/30
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/487 [..............................] - ETA: 1s - loss: 0.7751 - accuracy: 0.7510
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 23/487 [&gt;.............................] - ETA: 1s - loss: 0.7702 - accuracy: 0.7486
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 45/487 [=&gt;............................] - ETA: 1s - loss: 0.7758 - accuracy: 0.7469
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 67/487 [===&gt;..........................] - ETA: 0s - loss: 0.7732 - accuracy: 0.7477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 89/487 [====&gt;.........................] - ETA: 0s - loss: 0.7706 - accuracy: 0.7492
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
111/487 [=====&gt;........................] - ETA: 0s - loss: 0.7702 - accuracy: 0.7495
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
133/487 [=======&gt;......................] - ETA: 0s - loss: 0.7715 - accuracy: 0.7487
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
155/487 [========&gt;.....................] - ETA: 0s - loss: 0.7723 - accuracy: 0.7481
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
177/487 [=========&gt;....................] - ETA: 0s - loss: 0.7737 - accuracy: 0.7475
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
199/487 [===========&gt;..................] - ETA: 0s - loss: 0.7730 - accuracy: 0.7477
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
221/487 [============&gt;.................] - ETA: 0s - loss: 0.7731 - accuracy: 0.7475
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
243/487 [=============&gt;................] - ETA: 0s - loss: 0.7730 - accuracy: 0.7476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
265/487 [===============&gt;..............] - ETA: 0s - loss: 0.7724 - accuracy: 0.7476
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
286/487 [================&gt;.............] - ETA: 0s - loss: 0.7727 - accuracy: 0.7475
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
307/487 [=================&gt;............] - ETA: 0s - loss: 0.7729 - accuracy: 0.7473
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_5613</span><span class="o">/</span><span class="mf">3039212493.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>         <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>         <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="ne">---&gt; </span><span class="mi">23</span>         <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="o">.</span><span class="n">callbacks</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/keras/utils/traceback_utils.py</span> in <span class="ni">error_handler</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>         <span class="n">filtered_tb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">65</span>             <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span>         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">67</span>             <span class="n">filtered_tb</span> <span class="o">=</span> <span class="n">_process_traceback_frames</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">__traceback__</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/keras/engine/training.py</span> in <span class="ni">fit</span><span class="nt">(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq, max_queue_size, workers, use_multiprocessing)</span>
<span class="g g-Whitespace">   </span><span class="mi">1562</span>                         <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1563</span>                             <span class="n">callbacks</span><span class="o">.</span><span class="n">on_train_batch_begin</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1564</span>                             <span class="n">tmp_logs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_function</span><span class="p">(</span><span class="n">iterator</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1565</span>                             <span class="k">if</span> <span class="n">data_handler</span><span class="o">.</span><span class="n">should_sync</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1566</span>                                 <span class="n">context</span><span class="o">.</span><span class="n">async_wait</span><span class="p">()</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/util/traceback_utils.py</span> in <span class="ni">error_handler</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span>     <span class="n">filtered_tb</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">150</span>       <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>     <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>       <span class="n">filtered_tb</span> <span class="o">=</span> <span class="n">_process_traceback_frames</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">__traceback__</span><span class="p">)</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">913</span> 
<span class="g g-Whitespace">    </span><span class="mi">914</span>       <span class="k">with</span> <span class="n">OptionalXlaContext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_jit_compile</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">915</span>         <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">916</span> 
<span class="g g-Whitespace">    </span><span class="mi">917</span>       <span class="n">new_tracing_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experimental_get_tracing_count</span><span class="p">()</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py</span> in <span class="ni">_call</span><span class="nt">(self, *args, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">945</span>       <span class="c1"># In this case we have created variables on the first call, so we run the</span>
<span class="g g-Whitespace">    </span><span class="mi">946</span>       <span class="c1"># defunned version which is guaranteed to never create variables.</span>
<span class="ne">--&gt; </span><span class="mi">947</span>       <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stateless_fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>  <span class="c1"># pylint: disable=not-callable</span>
<span class="g g-Whitespace">    </span><span class="mi">948</span>     <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stateful_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">949</span>       <span class="c1"># Release the lock early so that multiple threads can perform the call</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/eager/function.py</span> in <span class="ni">__call__</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2495</span>        <span class="n">filtered_flat_args</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maybe_define_function</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2496</span>     <span class="k">return</span> <span class="n">graph_function</span><span class="o">.</span><span class="n">_call_flat</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">2497</span>         <span class="n">filtered_flat_args</span><span class="p">,</span> <span class="n">captured_inputs</span><span class="o">=</span><span class="n">graph_function</span><span class="o">.</span><span class="n">captured_inputs</span><span class="p">)</span>  <span class="c1"># pylint: disable=protected-access</span>
<span class="g g-Whitespace">   </span><span class="mi">2498</span> 
<span class="g g-Whitespace">   </span><span class="mi">2499</span>   <span class="nd">@property</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/eager/function.py</span> in <span class="ni">_call_flat</span><span class="nt">(self, args, captured_inputs, cancellation_manager)</span>
<span class="g g-Whitespace">   </span><span class="mi">1861</span>       <span class="c1"># No tape is watching; skip to running the function.</span>
<span class="g g-Whitespace">   </span><span class="mi">1862</span>       <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_call_outputs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_inference_function</span><span class="o">.</span><span class="n">call</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">1863</span>           <span class="n">ctx</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">cancellation_manager</span><span class="o">=</span><span class="n">cancellation_manager</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1864</span>     <span class="n">forward_backward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_forward_and_backward_functions</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1865</span>         <span class="n">args</span><span class="p">,</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/eager/function.py</span> in <span class="ni">call</span><span class="nt">(self, ctx, args, cancellation_manager)</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span>               <span class="n">inputs</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span>               <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">504</span>               <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">506</span>           <span class="n">outputs</span> <span class="o">=</span> <span class="n">execute</span><span class="o">.</span><span class="n">execute_with_cancellation</span><span class="p">(</span>

<span class="nn">/opt/hostedtoolcache/Python/3.7.15/x64/lib/python3.7/site-packages/tensorflow/python/eager/execute.py</span> in <span class="ni">quick_execute</span><span class="nt">(op_name, num_outputs, inputs, attrs, ctx, name)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span>     <span class="n">ctx</span><span class="o">.</span><span class="n">ensure_initialized</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span>     <span class="n">tensors</span> <span class="o">=</span> <span class="n">pywrap_tfe</span><span class="o">.</span><span class="n">TFE_Py_Execute</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">_handle</span><span class="p">,</span> <span class="n">device_name</span><span class="p">,</span> <span class="n">op_name</span><span class="p">,</span>
<span class="ne">---&gt; </span><span class="mi">55</span>                                         <span class="n">inputs</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">num_outputs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">56</span>   <span class="k">except</span> <span class="n">core</span><span class="o">.</span><span class="n">_NotOkStatusException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>     <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Again we will se the default precision to be <code class="docutils literal notranslate"><span class="pre">ap_fixed&lt;10,4&gt;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;LayerName&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">config</span><span class="p">[</span><span class="s2">&quot;LayerName&quot;</span><span class="p">][</span><span class="n">layer</span><span class="p">][</span><span class="s2">&quot;Trace&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">hls_model</span> <span class="o">=</span> <span class="n">hls4ml</span><span class="o">.</span><span class="n">converters</span><span class="o">.</span><span class="n">convert_from_keras_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">hls_config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;model_2/hls4ml_prj_1&quot;</span><span class="p">,</span>
    <span class="n">part</span><span class="o">=</span><span class="s2">&quot;xcu250-figd2104-2L-e&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">hls4ml</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">profiling</span><span class="o">.</span><span class="n">numerical</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">hls_model</span><span class="o">=</span><span class="n">hls_model</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpreting Sequential
Topology:
Layer name: fc1_input, layer type: InputLayer, input shapes: [[None, 16]], output shape: [None, 16]
Layer name: fc1, layer type: Dense, input shapes: [[None, 16]], output shape: [None, 64]
Layer name: relu1, layer type: Activation, input shapes: [[None, 64]], output shape: [None, 64]
Layer name: fc2, layer type: Dense, input shapes: [[None, 64]], output shape: [None, 32]
Layer name: relu2, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: fc3, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: relu3, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: output, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 5]
Layer name: softmax, layer type: Softmax, input shapes: [[None, 5]], output shape: [None, 5]
Creating HLS model
Interpreting Sequential
Topology:
Layer name: fc1_input, layer type: InputLayer, input shapes: [[None, 16]], output shape: [None, 16]
Layer name: fc1, layer type: Dense, input shapes: [[None, 16]], output shape: [None, 64]
Layer name: relu1, layer type: Activation, input shapes: [[None, 64]], output shape: [None, 64]
Layer name: fc2, layer type: Dense, input shapes: [[None, 64]], output shape: [None, 32]
Layer name: relu2, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: fc3, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: relu3, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: output, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 5]
Layer name: softmax, layer type: Softmax, input shapes: [[None, 5]], output shape: [None, 5]
Creating HLS model
Profiling weights (before optimization)
Profiling weights (final / after optimization)
Profiling activations (before optimization)
   fc1
32/32 [==============================] - 0s 595us/step
   relu1
32/32 [==============================] - 0s 664us/step
   fc2
32/32 [==============================] - 0s 760us/step
   relu2
32/32 [==============================] - 0s 924us/step
   fc3
32/32 [==============================] - 0s 743us/step
   relu3
32/32 [==============================] - 0s 676us/step
   output
32/32 [==============================] - 0s 684us/step
   softmax
32/32 [==============================] - 0s 794us/step
Profiling activations (final / after optimization)
Recompiling myproject with tracing
Writing HLS project
Done
   fc1
   relu1
   fc2
   relu2
   fc3
   relu3
   output
   softmax
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 432x288 with 1 Axes&gt;,
 &lt;Figure size 432x288 with 1 Axes&gt;,
 &lt;Figure size 432x288 with 1 Axes&gt;,
 &lt;Figure size 432x288 with 1 Axes&gt;)
</pre></div>
</div>
<img alt="_images/2.2_advanced_config_16_2.png" src="_images/2.2_advanced_config_16_2.png" />
<img alt="_images/2.2_advanced_config_16_3.png" src="_images/2.2_advanced_config_16_3.png" />
<img alt="_images/2.2_advanced_config_16_4.png" src="_images/2.2_advanced_config_16_4.png" />
<img alt="_images/2.2_advanced_config_16_5.png" src="_images/2.2_advanced_config_16_5.png" />
</div>
</div>
<p>You can see the difference in the weight profile plots between this model and the previous one quite clearly. Whereas before the smallest weight in the first layer was approximately <span class="math notranslate nohighlight">\(10^{-14}\)</span>, now its almost <span class="math notranslate nohighlight">\(10^{-24}\)</span>! However, it hasnt markedly improved the upper bound of the layers post-activation, so we will need to try something else.</p>
</section>
<section id="trace">
<h2>Trace<a class="headerlink" href="#trace" title="Permalink to this headline">#</a></h2>
<p>Another thing we can try is to use different precisions in different layers. In this case, it seems that the third layer is the one with the largest output, so perhaps we could increase only that precision and leave the others as is?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;LayerName&quot;</span><span class="p">][</span><span class="s2">&quot;fc3&quot;</span><span class="p">][</span><span class="s2">&quot;Precision&quot;</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ap_fixed&lt;12,6&gt;&quot;</span>
<span class="n">hls_model</span> <span class="o">=</span> <span class="n">hls4ml</span><span class="o">.</span><span class="n">converters</span><span class="o">.</span><span class="n">convert_from_keras_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">hls_config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;model_2/hls4ml_prj_2&quot;</span><span class="p">,</span>
    <span class="n">part</span><span class="o">=</span><span class="s2">&quot;xcu250-figd2104-2L-e&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpreting Sequential
Topology:
Layer name: fc1_input, layer type: InputLayer, input shapes: [[None, 16]], output shape: [None, 16]
Layer name: fc1, layer type: Dense, input shapes: [[None, 16]], output shape: [None, 64]
Layer name: relu1, layer type: Activation, input shapes: [[None, 64]], output shape: [None, 64]
Layer name: fc2, layer type: Dense, input shapes: [[None, 64]], output shape: [None, 32]
Layer name: relu2, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: fc3, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: relu3, layer type: Activation, input shapes: [[None, 32]], output shape: [None, 32]
Layer name: output, layer type: Dense, input shapes: [[None, 32]], output shape: [None, 5]
Layer name: softmax, layer type: Softmax, input shapes: [[None, 5]], output shape: [None, 5]
Creating HLS model
</pre></div>
</div>
</div>
</div>
<p>Now lets check how this model performs. We are also going to enable a functionality that will extract the intermediate network values from each layer, for botht the hls4ml model and the Keras model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hls_model</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
<span class="n">hls4ml_pred</span><span class="p">,</span> <span class="n">hls4ml_trace</span> <span class="o">=</span> <span class="n">hls_model</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">keras_trace</span> <span class="o">=</span> <span class="n">hls4ml</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">profiling</span><span class="o">.</span><span class="n">get_ymodel_keras</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">y_hls</span> <span class="o">=</span> <span class="n">hls_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing HLS project
Done
Recompiling myproject with tracing
Writing HLS project
Done
Processing fc1 in Keras model...
32/32 [==============================] - 0s 940us/step
32/32 [==============================] - 0s 660us/step
Processing relu1 in Keras model...
32/32 [==============================] - 0s 703us/step
Processing fc2 in Keras model...
32/32 [==============================] - 0s 3ms/step
32/32 [==============================] - 0s 814us/step
Processing relu2 in Keras model...
32/32 [==============================] - 0s 614us/step
Processing fc3 in Keras model...
32/32 [==============================] - 0s 637us/step
32/32 [==============================] - 0s 768us/step
Processing relu3 in Keras model...
32/32 [==============================] - 0s 560us/step
Processing output in Keras model...
32/32 [==============================] - 0s 601us/step
32/32 [==============================] - 0s 610us/step
Processing softmax in Keras model...
32/32 [==============================] - 0s 801us/step
Done taking outputs for Keras model.
</pre></div>
</div>
</div>
</div>
</section>
<section id="inspect">
<h2>Inspect<a class="headerlink" href="#inspect" title="Permalink to this headline">#</a></h2>
<p>Now we can print out, make plots, or do any other more detailed analysis on the output of each layer to understand the performance we see. Lets print the output of that third layer, for the first sample, for both the Keras and hls4ml models, and also make a plot of the mean difference per sample</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Keras layer &#39;fc3&#39;, first sample:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">keras_trace</span><span class="p">[</span><span class="s2">&quot;fc3&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hls4ml layer &#39;fc3&#39;, first sample:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hls4ml_trace</span><span class="p">[</span><span class="s2">&quot;fc3&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;layer fc3 diff, first sample:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hls4ml_trace</span><span class="p">[</span><span class="s2">&quot;fc3&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">keras_trace</span><span class="p">[</span><span class="s2">&quot;fc3&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Keras layer &#39;fc3&#39;, first sample:
[ 0.88930064 -3.8859491   1.5530485   1.7167063  -0.96600306  0.2857443
  0.21472323  0.30293974 -0.9408086   0.9514654   1.6882076   2.0520456
  1.8682225   0.01729417  1.457709    0.5599562   0.3849154   1.9730089
  0.11493069  2.945932    1.6105483   4.3975835  -1.0648595  -0.04774496
 -0.79464626 -1.3470746  -2.6663346  -0.90749    -0.02055568 -0.9426051
  0.61609864  2.0077007 ]
hls4ml layer &#39;fc3&#39;, first sample:
[ 0.359375 -2.859375  0.875     0.828125 -0.78125  -0.09375   0.09375
 -0.28125  -1.109375  0.390625  0.625     1.078125  0.796875 -0.125
  0.703125  0.0625    0.171875  0.90625  -0.328125  1.5       0.921875
  2.390625 -1.03125  -0.1875   -0.796875 -1.328125 -2.078125 -0.765625
 -0.15625  -0.875     0.265625  0.9375  ]
layer fc3 diff, first sample:
[-0.52992564  1.02657413 -0.67804849 -0.88858128  0.18475306 -0.37949431
 -0.12097323 -0.58418974 -0.16856641 -0.56084043 -1.06320763 -0.97392058
 -1.07134748 -0.14229417 -0.75458395 -0.49745619 -0.21304041 -1.06675887
 -0.44305569 -1.44593191 -0.68867326 -2.00695848  0.03360951 -0.13975504
 -0.00222874  0.01894963  0.58820963  0.14186502 -0.13569432  0.06760508
 -0.35047364 -1.07020068]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">hls4ml_trace</span><span class="p">[</span><span class="s2">&quot;fc3&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">keras_trace</span><span class="p">[</span><span class="s2">&quot;fc3&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span>
    <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;mean difference (hls4ml - keras)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2.2_advanced_config_24_0.png" src="_images/2.2_advanced_config_24_0.png" />
</div>
</div>
</section>
<section id="compare">
<h2>Compare<a class="headerlink" href="#compare" title="Permalink to this headline">#</a></h2>
<p>Its not looking great. Lets check the accuracy and ROC curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Keras  Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">accuracy_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_keras</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;hls4ml Accuracy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">accuracy_score</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_hls</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">makeRoc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_keras</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># reset the colors</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plotting</span><span class="o">.</span><span class="n">makeRoc</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_hls</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">),</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)]</span>
<span class="kn">from</span> <span class="nn">matplotlib.legend</span> <span class="kn">import</span> <span class="n">Legend</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">Legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;keras&quot;</span><span class="p">,</span> <span class="s2">&quot;hls4ml&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">leg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Keras  Accuracy: 0.7516506024096385
hls4ml Accuracy: 0.633421686746988
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x14fb4e5b0&gt;
</pre></div>
</div>
<img alt="_images/2.2_advanced_config_26_2.png" src="_images/2.2_advanced_config_26_2.png" />
</div>
</div>
<section id="improving">
<h3>Improving<a class="headerlink" href="#improving" title="Permalink to this headline">#</a></h3>
<p>Better, but still not great, especially depending on which class we look at. In principle we could try this for other layers, but eventually we may find we are just back to a larger model. Lets look at some other methods for reducing the size of the network.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2.1_getting_started.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Getting Started</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2.3_compression.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Compression (Pruning)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Javier Duarte, Dylan Rankin, and Patrick McCormack<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>